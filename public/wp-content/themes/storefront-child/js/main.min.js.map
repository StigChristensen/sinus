{"version":3,"sources":["main.js"],"names":["scrollTo","value","$","animate","scrollTop","show404","type","animateIn","elem","spinner","hasClass","addClass","removeClass","animateOut","container","find","message","html404","html","css","margin-bottom","setTimeout","mess","productsController","promise","productsSupplyer","then","products","render","sortPriceController","urlListener","getSearchParams","hash","parts","split","getParams","searchParams","searchController","href","window","location","indexOf","brands","productsUrl","search","console","log","site","site_url","sortHash","onhashchange","event","searchFormController","form","input","on","preventDefault","val","length","attr","replace","encoded","encodeURI","setUrl","decodedParams","each","i","e","p","decodeURIComponent","par","push","getSearchProducts","returnSortedSearch","params","sort","sortByFrequency","array","frequency","forEach","uniques","filter","a","b","cats","categories","tags","title","desc","description","stripped","toLowerCase","lowerCats","lowerTags","sorted","getTopHits","uniq","_","defer","resolve","Deferred","newProductsPromise","newProducts","price","param","paramtype","splitHash","splitParams","newDirection","pAsc","pDesc","sortUrl","pri","pt","base_url","h","hashBase","paramArray","base","getParam","cat","string","paramsLength","urlDataController","undefined","dataPromise","returnSortedPriceLow","done","fail","returnSortedPriceHigh","returnSortedCat","returnSortedBrand","returnSortedMultiple","getFirstList","getFirst","init","sortedPrice","reject","getSecondList","getSecond","firstPromise","finalSort","brandSorted","catSorted","sortdef","when","data","lower","j","c","sortPrice","initArray","object","parseInt","element","initialSort","f","reverse","storageAvailable","storage","x","setItem","removeItem","setPageIndex","index","pageIndex","getPageIndex","setMaxPages","max","maxPages","setQueryType","urlSearch","query","urlType","url","urlBrands","urlProducts","getQueryType","initialize","queryParams","key","productsCache","localStorage","JSON","parse","getItem","def","getPosts","action","queryType","offset","limit","dataObj","stringify","ajax","ajax_url","dataType","success","response","error","loop","loopDef","k","getTemplate","setTemplate","template","ti","te","ci","ce","grid","pages","pi","pe","remove","loopPromise","append","sortTags","scrollController","setMenuHeight","page","gridCartController","modalController","prepare","stock_quantity","stockIcon","id","featured_src","price_html","splice","join","tempDefer","catHtml","brandHtml","menuLeft","categoryContainer","brandContainer","pCat","pBrand","brand","sortController","delay","velocity","opacity","duration","display","easing","detach","initDirection","setDirection","dir","direction","priceSorter","changeDirection","newDir","currentDir","updateView","trig","content","windowHeight","height","scroll","document","requestAnimationFrame","validateEmail","email","regex","test","validateInput","allowedChars","validateNumber","isNumber","shopMsg","msg","atcModal","top","z-index","mainMenu","documentHeight","jQuery","CartController","MenuController","removeFromCartController","reserveFormController","scrollHeaderController","embedVidController","fpVideoController","fpBackgroundController","focus","this","blur","modalRender","addEventListeners","modalClose","get_content","contentDef","dataObject","animateSpinnerIn","modalOverlay","animateSpinnerOut","modal","prods","clickArea","prod_id","getData","imagesHandler","setIndex","firstImg","img","theme_path","bgContainer","controller","getIndex","curImg","newImg","image","n","newIndex","complete","load","vid","addEventListener","animShowVideo","animOutVideo","vidHeight","vidElement","movingContent","paused","play","getElementById","width","modifyHeader","linkHeader","validateEmailOnBlur","emailInput","isEmail","validateNameOnBlur","nameInput","isTrustedCharacters","validateNumberOnBlur","phoneInput","submitListener","packData","customer_html","inputArray","customer_email","sendForm","customerData","stripResponse","trim","animateSuccess","validSuccess","submitBtn","inputs","name","productTextController","toggleClass","textIcon","productLeft","productRight","singleProductHeightController","handler","contentHeight","imageHeight","mainImage","initVideo","vidUrl","vidFrame","vidId","constructedHtml","addBtn","cart","prodTitle","cartNumber","cartInt","text","product_id","updatedNum","remBtn","qtyElem","siblings","qty","quantity","animateMenu","updateHeaderOpen","updateHeaderClose","rawIconCss","cartIcon","rawSearchCss","searchForm","rawCartContCss","cartContents","iconRight","searchRight","cartContRight","right","menuLinks","aHref","menuHeaders","navigate","menuBtn","headerLinkRow"],"mappings":"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","file":"main.min.js","sourcesContent":["// Test if ie10 - adds class \"ie10\" to HTML tag, if true. - Excludes IE11\nif (/*@cc_on!@*/false && document.documentMode === 10) {\n    document.documentElement.className+=' ie10';\n}\n\njQuery(document).on('ready', function() {\n  $ = jQuery;\n\n  new CartController();\n  new MenuController();\n  new removeFromCartController();\n  new gridCartController();\n  new reserveFormController();\n  new scrollHeaderController();\n  new embedVidController();\n  new fpVideoController();\n  new fpBackgroundController();\n  urlListener();\n  searchFormController();\n\n  // labels for input fields\n  $(\"form :input\").focus(function() {\n    $(\"label[for='\" + this.id + \"']\").addClass(\"focus\");\n  }).blur(function() {\n    $(\"label\").removeClass(\"focus\");\n  });\n}); // End Ready\n\nvar documentHeight;\n\nfunction scrollTo(value) {\n  $('html, body').animate({\n    scrollTop: value\n  }, 700);\n}\n\nfunction show404(type) {\n  var container = $('body').find('.product-list-grid'),\n      spinner = $('body').find('.spinner');\n      html404;\n\n  if ( type === 'search' ) {\n    var message = 'Der er desværre ingen resultater, der matcher det du søger efter.';\n    var html404 = '<div class=\"contained-404 hidden\"><h3>' + message + '</h3></div>';\n    $(container).html(html404);\n\n    $(container).css({\n        'margin-bottom': 0\n      });\n\n    setTimeout(function() {\n      var mess = $(container).find('.contained-404');\n      animateIn(mess);\n    }, 200);\n  }\n\n  if ( type === 'remove' ) {\n    var mess = $(container).find('.contained-404');\n    if ( mess && !$(mess).hasClass('hidden') ) {\n      $(container).css({\n          'margin-bottom': 100\n        });\n\n      setTimeout(function() {\n\n        animateOut(mess);\n      }, 200);\n    }\n  }\n\n  function animateIn(elem) {\n    if ( !$(spinner).hasClass('hidden') ) {\n      $(spinner).addClass('hidden');\n    }\n    $(elem).removeClass('hidden');\n  }\n\n  function animateOut(elem) {\n    $(elem).addClass('hidden');\n  }\n}\n\nvar modalController = function() {\n  var prods = $('body').find('li.product'),\n      modal = $('body').find('.product-modal'),\n      content = $(modal).find('.modal-content');\n      modalOverlay = $('body').find('.product-modal-overlay'),\n      modalClose = $(modal).find('.modal-close-btn'),\n      spinner = $('body').find('.spinner');\n\n  $(prods).each(function(i,e) {\n    var clickArea = $(e).find('.click-area');\n\n    $(clickArea).on('click', function(event) {\n      var prod_id = $(e).data('singleid');\n      event.preventDefault();\n      animateSpinnerIn();\n\n      var getData = get_content(prod_id);\n\n      getData.done(function(data) {\n        animateSpinnerOut();\n        modalRender(data, modal);\n      })\n      .fail(function() {\n        return;\n      });\n    });\n  });\n\n  function modalRender(data) {\n    $(content).html(data);\n\n    setTimeout(function() {\n      new embedVidController();\n      new gridCartController();\n      addEventListeners();\n      animateIn();\n    }, 200);\n  }\n\n  function addEventListeners() {\n    // $(modalOverlay).on('click', function() {\n    //   animateOut();\n    // });\n\n    $(modalClose).on('click', function() {\n      animateOut();\n    });\n  }\n\n  function get_content(id) {\n    var contentDef = $.Deferred(),\n        id = id;\n        url = site.ajax_url + '?action=sinus_getsinglehtml',\n        dataObject = {\n          id: id\n        }\n\n    var data = JSON.stringify(dataObject);\n\n    $.ajax({\n      url: url,\n      type: \"POST\",\n      data: data,\n      success: function(response) {\n        contentDef.resolve(response);\n      },\n      error: function(response) {\n        contentDef.reject(response);\n      }\n    });\n    return contentDef;\n  }\n\n  function animateSpinnerIn() {\n    $(modalOverlay).removeClass('hidden');\n    $(spinner).removeClass('hidden');\n  }\n\n  function animateSpinnerOut() {\n    $(modalOverlay).addClass('hidden');\n    $(spinner).addClass('hidden');\n  }\n\n  function animateIn() {\n    $(modal).removeClass('hidden');\n  }\n\n  function animateOut() {\n    $(modal).addClass('hidden');\n  }\n\n}\n\nfunction productsController() {\n  var promise = productsSupplyer();\n  promise.then(function(products) {\n    render(products);\n  });\n  sortPriceController('asc');\n}\n\nfunction urlListener() {\n  var href = window.location.href,\n      hash = window.location.hash,\n      type = href.indexOf('/type/'),\n      brands = href.indexOf('/brands/'),\n      productsUrl = href.indexOf('/products/'),\n      search = href.indexOf('#s='),\n      initParams,\n      base_url;\n\n  if ( type === -1 && brands === -1 && productsUrl === -1 ) {\n    console.log('Dont find products, just add listener');\n  } else {\n    if ( hash ) {\n      if ( search !== -1 ) {\n        if ( productsUrl === -1 ) {\n          window.location.href = site.site_url + '/products/' + hash;\n        }\n        getSearchParams(hash);\n      } else {\n        sortHash(hash);\n      }\n    } else {\n      if ( type !== -1 || brands !== -1 ) {\n          productsController();\n          console.log('products');\n        }\n      }\n    }\n\n  window.onhashchange = function(event) {\n    hash = window.location.hash;\n    search = hash.indexOf('#s=');\n\n    if ( search !== -1 ) {\n      if ( productsUrl === -1 ) {\n        window.location.href = site.site_url + '/products/' + hash;\n      }\n      getSearchParams(hash);\n    } else {\n      sortHash(hash);\n    }\n  }\n\n  function getSearchParams(hash) {\n    var parts = hash.split('#s=');\n\n    var getParams = parts[1].split('&');\n    var searchParams = getParams[0].split('+');\n    searchController(searchParams);\n  }\n}\n\nfunction searchFormController() {\n  var form = $('body').find('form.sinus-search'),\n      input = $(form).find('input[type=text]');\n\n  $(form).on('submit', function(event) {\n    event.preventDefault();\n    var val = $(input).val();\n\n    if ( val.length < 1 ) {\n      $(input).attr('placeholder', 'Mindst 3 tegn...');\n      return;\n    }\n\n    if ( val.length > 1 ) {\n      if ( val.indexOf(' ') !== -1 ) {\n        val.replace(' ', '+');\n      }\n\n      var encoded = encodeURI(val);\n      var hash = '#s=' + encoded;\n\n      setUrl(hash);\n    }\n  });\n}\n\nfunction searchController(searchParams) {\n  if ( searchParams ) {\n    var decodedParams = [];\n    $(searchParams).each(function(i,e) {\n      var p = decodeURIComponent(e);\n\n        if ( p.indexOf(' ') !== -1 ) {\n          var split = p.split(' ');\n          $(split).each(function(i, par) {\n            decodedParams.push(par);\n          });\n        } else {\n          decodedParams.push(p);\n        }\n    });\n\n    var getSearchProducts = returnSortedSearch(decodedParams);\n\n    getSearchProducts.then(function(products) {\n      render(products);\n    });\n\n  } else {\n    return;\n  }\n}\n\nfunction returnSortedSearch(params, products) {\n  var sorted = [],\n      defer = $.Deferred();\n\n  if ( !products ) {\n    var newProductsPromise = productsSupplyer();\n    newProductsPromise.then(function(newProducts) {\n      var results = sort(newProducts);\n    });\n  } else {\n    sort(products);\n  }\n\n  function sort(products) {\n    $(products).each(function(i,e) {\n      var cats = e.categories,\n          tags = e.tags,\n          title = e.title,\n          desc = e.description,\n          stripped = desc.replace(/<(?:.|\\n)*?>/gm, '').toLowerCase(),\n          lowerCats = [],\n          lowerTags = [];\n\n      var lowerTitle = title.toLowerCase();\n      var lowerDesc = desc.toLowerCase();\n\n      $(cats).each(function(i, a) {\n        var b = a.toLowerCase();\n        lowerCats.push(b);\n      });\n\n      $(tags).each(function(i, a) {\n        var b = a.toLowerCase();\n        lowerTags.push(b);\n      });\n\n\n      for (var i = 0; i < params.length; i++) {\n        par = params[i].toLowerCase();\n\n        if ( lowerCats.indexOf(par) !== -1 ) {\n          sorted.push(e);\n        }\n\n        if ( lowerTags.indexOf(par) !== -1 ) {\n          sorted.push(e);\n        }\n\n        if ( title.indexOf(par) !== -1 ) {\n          sorted.push(e);\n        }\n\n        if ( stripped.indexOf(par) !== -1 ) {\n          sorted.push(e);\n        }\n      }\n\n    });\n\n    function sortByFrequency(array) {\n      var frequency = {};\n\n      array.forEach(function(value) { frequency[value] = 0; });\n\n      var uniques = array.filter(function(value) {\n          return ++frequency[value] == 1;\n      });\n\n      return uniques.sort(function(a, b) {\n          return frequency[b] - frequency[a];\n      });\n    }\n\n    var getTopHits = sorted.sort(sortByFrequency(sorted));\n    var uniq = _.uniq(getTopHits, true);\n\n    defer.resolve(uniq);\n  }\n\n  return defer;\n}\n\nfunction sortHash(hash) {\n  var price, param, paramtype, splitHash, splitParams, newDirection;\n\n  if ( hash.indexOf('#s=') !== -1 ) {\n    return;\n  }\n\n  if ( hash.indexOf('price_asc') !== -1 ) {\n    price = 'price_asc';\n    newDirection = 'price_desc';\n    sortPriceController(newDirection);\n  }\n\n  if ( hash.indexOf('price_desc') !== -1 ) {\n    price = 'price_desc';\n    newDirection = 'price_asc';\n    sortPriceController(newDirection);\n  }\n\n  if ( hash.indexOf('category') !== -1 ) {\n    paramtype = 'category';\n  }\n\n  if ( hash.indexOf('brand') !== -1 ) {\n    paramtype = 'brand';\n  }\n\n  if ( paramtype ) {\n    splitHash = hash.split('=');\n    splitParams = splitHash[1].split('+');\n    var pAsc = splitParams.indexOf('price_asc');\n    var pDesc = splitParams.indexOf('price_desc');\n\n    if ( pAsc === 0 || pDesc === 0 ) {\n      param = splitParams[2];\n    } else {\n      param = splitParams[1];\n    }\n  }\n\n  console.log(price, paramtype, param);\n\n  sortUrl(price, param, paramtype);\n}\n\nfunction sortUrl(price, param, paramtype) {\n  var h = window.location.hash,\n      href = window.location.href,\n      pri, par, pt,\n      hashBase = '#sort=',\n      paramArray = [],\n      base_url;\n\n  if ( h ) {\n    var base = href.split('#');\n    base_url = base[0];\n\n    if ( price ) {\n      pri = price;\n      paramArray.push(pri);\n    } else {\n      if ( h.indexOf('price_asc') !== -1 ) {\n        pri = 'price_asc';\n        paramArray.push(pri);\n      }\n      if ( h.indexOf('price_desc') !== -1 ) {\n        pri = 'price_desc';\n        paramArray.push(pri);\n      }\n    }\n\n    if ( param ) {\n      par = param;\n      pt = paramtype;\n      paramArray.push(pt);\n      paramArray.push(par);\n    } else {\n      if ( h.indexOf('category') !== -1 ) {\n        paramtype = 'category';\n        var getParam = h.split('category');\n        var cat = getParam[1].replace('+', '');\n        par = cat;\n        paramArray.push(paramtype);\n        paramArray.push(par);\n      }\n\n      if ( h.indexOf('brand') !== -1 ) {\n        paramtype = 'brand';\n        var getParam = h.split('brand');\n        var cat = getParam[1].replace('+', '');\n        par = cat;\n        paramArray.push(paramtype);\n        paramArray.push(par);\n      }\n    }\n\n  } else {\n    base_url = href;\n\n    if ( price ) {\n      pri = price;\n      paramArray.push(pri);\n    }\n\n    if ( param ) {\n      par = param;\n      pt = paramtype;\n      paramArray.push(pt);\n      paramArray.push(par);\n    }\n  }\n\n  var string = '';\n      string = hashBase;\n\n  var paramsLength = paramArray.length;\n  $(paramArray).each(function(i, e) {\n    if ( i < (paramsLength-1) ) {\n      string += e.toLowerCase() + '+';\n    }\n    if ( i === (paramsLength-1) ) {\n      string += e.toLowerCase();\n    }\n  });\n\n  setUrl(string, base_url);\n  urlDataController(pri, par, pt);\n}\n\nfunction setUrl(hash, href) {\n  if ( !href ) {\n    window.location.hash = hash;\n  } else {\n    window.location.href = href + hash;\n  }\n}\n\nfunction urlDataController(price, param, paramtype) {\n  if ( price && param === undefined && param === undefined ) {\n\n    if ( price === 'price_asc' ) {\n      var dataPromise = returnSortedPriceLow();\n\n      dataPromise.done(function(products) {\n        render(products);\n      })\n      .fail(function() {\n          console.log('failed!');\n      });\n    }\n\n    if ( price === 'price_desc' ) {\n      var dataPromise = returnSortedPriceHigh();\n\n      dataPromise.done(function(products) {\n        render(products);\n      })\n      .fail(function() {\n          console.log('failed!');\n      });\n    }\n  }\n\n  if ( price === undefined && param && paramtype ) {\n    if ( paramtype === 'category' ) {\n      var dataPromise = returnSortedCat(param);\n\n      dataPromise.done(function(products) {\n        render(products);\n      })\n      .fail(function() {\n          console.log('failed!');\n      });\n    }\n\n    if ( paramtype === 'brand' ) {\n      var dataPromise = returnSortedBrand(param);\n\n      dataPromise.done(function(products) {\n        render(products);\n      })\n      .fail(function() {\n          console.log('failed!');\n      });\n    }\n  }\n\n  if ( price && param && paramtype) {\n    var dataPromise = returnSortedMultiple(price, param, paramtype);\n\n    dataPromise.done(function(products) {\n      render(products);\n    })\n    .fail(function() {\n        console.log('failed!');\n    });\n  }\n\n  sortPriceController();\n}\n\nfunction returnSortedMultiple(price, param, paramtype) {\n  var sortdef = $.Deferred();\n\n  function getFirstList() {\n    var getFirst = $.Deferred();\n\n    if ( price ) {\n      if ( price === 'price_asc' ) {\n        var init = returnSortedPriceLow();\n\n        init.then(function(sortedPrice) {\n          getFirst.resolve(sortedPrice);\n        });\n      }\n\n      if ( price === 'price_desc' ) {\n        var init = returnSortedPriceHigh();\n\n        init.then(function(sortedPrice) {\n          getFirst.resolve(sortedPrice);\n        });\n      }\n\n    } else {\n      getFirst.reject('first rejected');\n    }\n    return getFirst;\n  }\n\n  function getSecondList() {\n    var getSecond = $.Deferred();\n    var firstPromise = getFirstList();\n\n    firstPromise.then(function(sortedPrice) {\n      if ( sortedPrice ) {\n\n        if ( param ) {\n          var par = param.toLowerCase();\n          if ( paramtype === 'brand' ) {\n            var finalSort = returnSortedBrand(par, sortedPrice);\n            finalSort.then(function(brandSorted) {\n              getSecond.resolve(brandSorted);\n            });\n          }\n\n          if ( paramtype === 'category' ) {\n            var finalSort = returnSortedCat(par, sortedPrice);\n            finalSort.then(function(catSorted) {\n              getSecond.resolve(catSorted);\n            });\n          }\n        } else {\n          getSecond.reject('rejected - no param', sortedPrice);\n        }\n      }\n\n      if ( !sortedPrice && param ) {\n        var par = param.toLowerCase();\n        if ( paramtype === 'brand' ) {\n            var finalSort = returnSortedBrand(par);\n            finalSort.then(function(brandSorted) {\n              getSecond.resolve(brandSorted);\n            });\n          }\n\n          if ( paramtype === 'category' ) {\n            var finalSort = returnSortedCat(par);\n            finalSort.then(function(catSorted) {\n              getSecond.resolve(catSorted);\n            });\n          }\n      } else {\n        getSecond.reject('rejected !products && param');\n      }\n    });\n\n    return getSecond;\n  }\n\n  $.when( getSecondList() ).then(function(data) {\n    sortdef.resolve(data);\n  });\n\n  return sortdef;\n}\n\n\n\nfunction returnSortedCat(param, products) {\n  var sorted = [],\n      defer = $.Deferred();\n\n  if ( !products ) {\n    var newProductsPromise = productsSupplyer();\n\n    newProductsPromise.then(function(newProducts) {\n      var par = param.toLowerCase();\n      $(newProducts).each(function(i,e) {\n        var cats = e.categories;\n        var lower = [];\n\n        $(cats).each(function(j,c) {\n          lower.push(c.toLowerCase());\n        });\n\n        if ( lower.indexOf(par) !== -1 ) {\n          sorted.push(e);\n        }\n      });\n\n      defer.resolve(sorted);\n    });\n  } else {\n    function sort() {\n      var par = param.toLowerCase();\n      $(products).each(function(i,e) {\n        var cats = e.categories;\n        var lower = [];\n\n        $(cats).each(function(j,c) {\n          lower.push(c.toLowerCase());\n        });\n\n        if ( lower.indexOf(par) !== -1 ) {\n          sorted.push(e);\n        }\n      });\n\n      defer.resolve(sorted);\n    }\n\n    sort();\n  }\n\n  return defer;\n}\n\nfunction returnSortedBrand(param, products) {\n  var sorted = [];\n  var defer = $.Deferred();\n\n  if ( !products ) {\n    var newProductsPromise = productsSupplyer();\n\n    newProductsPromise.then(function(newProducts) {\n      var par = param.toLowerCase();\n\n      $(newProducts).each(function(i,e) {\n        var brands = e.tags;\n        var lower = [];\n\n        $(brands).each(function(j,b) {\n          lower.push(b.toLowerCase());\n        });\n\n        if ( lower.indexOf(par) !== -1 ) {\n          sorted.push(e);\n        }\n      });\n\n      defer.resolve(sorted);\n    });\n  } else {\n    function sort() {\n      var par = param.toLowerCase();\n      $(products).each(function(i,e) {\n        var brands = e.tags;\n        var lower = [];\n\n        $(brands).each(function(j,c) {\n          lower.push(c.toLowerCase());\n        });\n\n        if ( lower.indexOf(par) !== -1 ) {\n          sorted.push(e);\n        }\n      });\n\n      defer.resolve(sorted);\n    }\n\n    sort();\n  }\n\n  return defer;\n}\n\nfunction returnSortedPriceLow() {\n  var newProductsPromise = productsSupplyer(),\n      defer = $.Deferred();\n\n  newProductsPromise.then(function(newProducts) {\n    var initArray = [],\n        sorted = [];\n\n    $(newProducts).each(function(i,e) {\n      var object = {\n        price: parseInt(e['regular_price']),\n        element: e\n      }\n      initArray.push(object);\n    });\n\n    function sortPrice(a,b) {\n      return a.price - b.price;\n    }\n\n    var initialSort = initArray.sort(sortPrice);\n\n    $(initialSort).each(function(j,f) {\n      sorted.push(f.element);\n    });\n\n    defer.resolve(sorted);\n  });\n\n  return defer;\n}\n\nfunction returnSortedPriceHigh() {\n  var newProductsPromise = productsSupplyer(),\n      defer = $.Deferred();\n\n  newProductsPromise.then(function(newProducts) {\n    var initArray = [],\n        sorted = [];\n\n    $(newProducts).each(function(i,e) {\n      var object = {\n        price: parseInt(e['regular_price']),\n        element: e\n      }\n      initArray.push(object);\n    });\n\n    function sortPrice(a,b) {\n      return a.price - b.price;\n    }\n\n    var initialSort = initArray.sort(sortPrice).reverse();\n\n    $(initialSort).each(function(j,f) {\n      sorted.push(f.element);\n    });\n\n    defer.resolve(sorted);\n  });\n\n  return defer;\n}\n\n\nfunction productsSupplyer() {\n  var url = window.location.href;\n  var hash = window.location.hash;\n  var def = $.Deferred();\n  var urlType = url.indexOf('/type/'),\n      urlBrands = url.indexOf('/brands/'),\n      urlSearch = hash.indexOf('#s='),\n      urlProducts = url.indexOf('/products/');\n\n  if ( urlType === -1 && urlBrands === -1 && urlSearch === -1 && urlProducts === -1 ) {\n    console.log('Exited from productsModel');\n    return;\n  }\n\n  var productsCache,\n      products,\n      storage = storageAvailable('localStorage'),\n      target = $('body').find('.product-list-grid'),\n      pageIndex,\n      maxPages,\n      type,\n      brand,\n      key,\n      query = {};\n      tags = {\n        brands: [],\n        categories: []\n      };\n      initialize();\n\n  function storageAvailable(type) {\n    try {\n      var storage = window[type],\n        x = '__storage_test__';\n      storage.setItem(x, x);\n      storage.removeItem(x);\n      return true;\n    }\n    catch(e) {\n      return false;\n    }\n  }\n\n  function setPageIndex(index) {\n    pageIndex = index;\n  }\n\n  function getPageIndex() {\n    var p = pageIndex;\n    return p;\n  }\n\n  function setMaxPages(max) {\n    maxPages = max;\n  }\n\n  function getMaxPages() {\n    var p = maxPages;\n    return p;\n  }\n\n  function setQueryType() {\n    var parts;\n\n    if ( urlSearch !== -1 ) {\n      parts = [];\n\n      query = {\n        type: 'all',\n        param: 'null'\n      }\n    } else {\n\n      if ( urlType !== -1 ) {\n        parts = url.split('/');\n\n        query = {\n          type: 'type',\n          param: parts[4]\n        }\n      }\n\n      if ( urlBrands !== -1 ) {\n        parts = url.split('/');\n\n        query = {\n          type: 'brand',\n          param: parts[4]\n        }\n      }\n\n      if ( urlProducts !== -1 ) {\n        parts = [];\n\n        query = {\n          type: 'all',\n          param: 'null'\n        }\n      }\n    }\n  }\n\n  function getQueryType() {\n    return query;\n  }\n\n  function initialize() {\n    var container = $('body').find('.products-container'),\n        pageIndex = $(container).data('page'),\n        maxPages = $(container).data('maxpages'),\n        type = $(container).data('cat'),\n        brand = $(container).data('tag');\n        setQueryType();\n        setMaxPages(maxPages);\n\n    if ( !pageIndex || pageIndex > maxPages ) {\n      setPageIndex(1);\n    } else {\n      setPageIndex(pageIndex);\n    }\n\n    var int = getPageIndex();\n    var queryParams = getQueryType();\n    key = queryParams.type + '_' + queryParams.param;\n\n    if ( storage ) {\n      productsCache = localStorage,\n      products = JSON.parse(productsCache.getItem(key));\n      if (products) {\n        def.resolve(products);\n      } else {\n        getPosts();\n      }\n    }\n  }\n\n  function getPosts() {\n    var queryType = getQueryType(),\n        action,\n        type = queryType.type;\n\n    if ( type === 'type' ) {\n      action = '?action=sinus_type';\n    }\n    if ( type === 'brand' ) {\n      action = '?action=sinus_brand';\n    }\n\n    if ( type === 'all' ) {\n      action = '?action=sinus_products';\n    }\n\n    console.log(queryType);\n\n    var queryParams = {\n        offset: 0,\n        limit: -1,\n        param: queryType.param\n    },\n    dataObj = JSON.stringify(queryParams);\n\n    $.ajax({\n      url: site.ajax_url + action,\n      type: \"POST\",\n      data: dataObj,\n      dataType: 'json',\n      success: function(response) {\n        products = response.products;\n        productsCache.setItem(key, JSON.stringify(products));\n        def.resolve(products);\n      },\n      error: function(response) {\n        console.log(response);\n      }\n    });\n  }\n\n  return def;\n}\n\nfunction render(products) {\n  if ( products.length > 0 ) {\n    show404('remove');\n  } else {\n    show404('search');\n    return;\n  }\n\n  var grid = $('body').find('.product-list-grid'),\n      spinner = $('body').find('.spinner'),\n      pages = $('body').find('.page.products'),\n      length = products.length;\n\n  if ( !$(spinner).hasClass('hidden') ) {\n    $(spinner).addClass('hidden');\n  }\n\n  if ( pages ) {\n    $(pages).each(function(pi,pe) {\n      $(pe).remove();\n    });\n  }\n\n  function loop() {\n    loopDef = $.Deferred();\n\n    var pageIndex = 1;\n    var html = '<div class=\"page products page-1 hidden\">';\n        html += '<ul class=\"products\">';\n\n    $(products).each(function(i, e) {\n      var k = i + 1;\n\n      var getTemplate = setTemplate(e);\n\n      getTemplate.then(function(template) {\n        html += template;\n      });\n\n      $(e.tags).each(function(ti, te) {\n        tags.brands.push(te);\n      });\n\n      $(e.categories).each(function(ci, ce) {\n        tags.categories.push(ce);\n      });\n\n      if ( k % 24 === 0 && i < length ) {\n        pageIndex++;\n        html += '</ul>';\n        html += '</div>';\n        html += '<div class=\"page products page-' + pageIndex + ' hidden\">';\n        html += '<ul class=\"products\">';\n      }\n    });\n\n    html += '</ul>';\n    html += '</div>';\n\n    loopDef.resolve(html);\n    return loopDef;\n  }\n\n  var loopPromise = loop();\n\n  loopPromise.then(function(html) {\n    $(grid).append(html);\n    sortTags(tags);\n    scrollController();\n    setMenuHeight();\n    var page = $('body').find('.page.page-1');\n    $(page).removeClass('hidden');\n    setTimeout(function() {\n      new gridCartController();\n      new modalController();\n    }, 1500);\n  });\n\n}\n\n\nfunction setTemplate(e) {\n  var stockIcon, template;\n      tempDefer = $.Deferred();\n\n  function prepare() {\n    if ( e.stock_quantity === 0 ) {\n      stockIcon = '<div class=\"in-stock-icon\"><span>PÅ LAGER: <i class=\"fa fa-minus-square\"></i></span></div>';\n    }\n\n    if ( e.stock_quantity > 0 ) {\n      stockIcon = '<div class=\"in-stock-icon\"><span>PÅ LAGER: <i class=\"fa fa-check-square\"></i></span></div>';\n    }\n\n    var desc = e.description;\n    var stripped = desc.replace(/<(?:.|\\n)*?>/gm, '');\n\n    var template = '<li class=\"product\" itemscope itemtype=\"http://schema.org/Product\" data-singleid=\"' + e.id + '\">';\n        template += '<div class=\"click-area\"></div>';\n        template += stockIcon;\n        template += '<img src=\"' + e.featured_src + '\" alt=\"' + e.title + ' product image produkt billede Sinus-store Copenhagen København Denmark\" />';\n        template += '<div class=\"product-title\" itemprop=\"name\"><h3>' + e.title + '</h3></div>';\n        template += '<div class=\"product-price\">' + e.price_html + '<div class=\"add-button\" data-href=\"' + e.id + '\" data-title=\"' + e.title + '\"><svg version=\"1.1\" baseProfile=\"tiny\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"x=\"0px\" y=\"0px\" viewBox=\"0 0 60 60\" xml:space=\"preserve\"><line class=\"svg-line\" fill=\"none\" stroke=\"#007c96\" stroke-width=\"10\" stroke-miterlimit=\"10\" x1=\"30\" y1=\"6\" x2=\"30\" y2=\"54\"/><line class=\"svg-line\" fill=\"none\" stroke=\"#007c96\" stroke-width=\"10\" stroke-miterlimit=\"10\" x1=\"6\" y1=\"30\" x2=\"54\" y2=\"30\"/></svg><span class=\"add-info\">Tilføj til kurv</span></div></div>';\n        template += '<div class=\"sinus-product-info\"><div class=\"short-desc\" itemprop=\"description\"><p>' + stripped.split(\" \").splice(0, 40).join(\" \") + '... </p><i class=\"fa fa-chevron-circle-up\"></i></div></div>';\n        template += '</li>';\n\n    tempDefer.resolve(template);\n  }\n\n  prepare();\n  return tempDefer;\n}\n\n\nfunction sortTags(tags) {\n  var menuLeft = $('body').find('.menu-left'),\n      categoryContainer = $(menuLeft).find('.categories'),\n      brandContainer = $(menuLeft).find('.brands'),\n      categories = _.uniq(tags.categories),\n      brands = _.uniq(tags.brands),\n      pCat = $(categoryContainer).find('p'),\n      pBrand = $(brandContainer).find('p'),\n      catHtml,\n      brandHtml;\n\n  if ( pCat.length !== 0 || pBrand.length !== 0 ) {\n    return\n  } else {\n    $(categories).each(function(i, cat) {\n      catHtml = '<p data-cat=\"' + cat + '\"><i class=\"fa fa-search-plus\"></i>' + cat + '</p>';\n      $(categoryContainer).append(catHtml);\n    });\n\n    $(brands).each(function(i, brand) {\n      brandHtml = '<p data-brand=\"' + brand + '\"><i class=\"fa fa-search-plus\"></i>' + brand + '</p>';\n      $(brandContainer).append(brandHtml);\n    });\n\n    setTimeout(function() {\n      sortController();\n    }, 1500);\n  }\n}\n\nfunction sortController() {\n  var menuLeft = $('body').find('.menu-left'),\n      categoryContainer = $(menuLeft).find('.categories'),\n      brandContainer = $(menuLeft).find('.brands'),\n      pCat = $(categoryContainer).find('p'),\n      pBrand = $(brandContainer).find('p'),\n      products = $('body').find('li.product'),\n      pages = $('body').find('.page.products'),\n      href = window.location.href;\n\n  $(pCat).each(function(i,e) {\n    var param = $(e).data('cat');\n\n    $(e).on('click', function() {\n      $(pages).each(function(i,e) {\n        var delay = 50 * i;\n        $(e).velocity({'opacity': 0}, {duration: 500, delay: delay, display: 'none', easing: [.24,.63,.5,.99]});\n        setTimeout(function() {\n          $(e).detach();\n        }, 600+delay);\n      });\n      var paramtype = 'category';\n      var price = null;\n      sortUrl(price, param, paramtype);\n\n    });\n  });\n\n  $(pBrand).each(function(i,e) {\n    var param = $(e).data('brand');\n\n    $(e).on('click', function() {\n      $(pages).each(function(i,e) {\n        var delay = 50 * i;\n        $(e).velocity({'opacity': 0}, {duration: 500, delay: delay, display: 'none', easing: [.24,.63,.5,.99]});\n        setTimeout(function() {\n          $(e).detach();\n        }, 600+delay);\n      });\n      var paramtype = 'brand';\n      var price = null;\n      sortUrl(price, param, paramtype);\n    });\n  });\n}\n\nfunction sortPriceController(initDirection) {\n  function setDirection(dir) {\n    direction = dir;\n  }\n\n  function getDirection() {\n    return direction;\n  }\n\n  var priceSorter = $('.menu-left').find('.sort-links > .price-sorter');\n\n  if ( !priceSorter ) {\n    return;\n  }\n\n  $(priceSorter).on('click', function() {\n    console.log('cllcik');\n    if ( initDirection ) {\n      currentDir = initDirection;\n      setDirection(initDirection);\n    } else {\n      var currentDir = 'asc';\n    }\n\n    if ( currentDir === 'asc' ) {\n      changeDirection('desc');\n      var price = 'price_asc';\n      sortUrl(price);\n    }\n\n    if ( currentDir === 'desc' ) {\n      changeDirection('asc');\n      var price = 'price_desc';\n      sortUrl(price);\n    }\n\n    function changeDirection(newDir) {\n      setTimeout(function () {\n        setDirection(newDir);\n      }, 1500);\n    }\n  });\n}\n\nfunction scrollController() {\n  var pages = $('body').find('.page.products.hidden'),\n      content = $('body').find('.site-content'),\n      height = $(content).height(),\n      windowHeight = $(window).height();\n\n  if ( !pages ) {\n    return;\n  }\n\n  $(window).on('scroll', function() {\n    var scroll = $(document).scrollTop(),\n        height = $(content).height();\n\n    if ( scroll >= ((height - windowHeight) - 700) ) {\n      window.requestAnimationFrame(function() {\n        updateView();\n      });\n    }\n  });\n\n  function updateView() {\n    var trig = 0;\n    if (!pages[0] || trig > 0 ) {\n      return;\n    } else {\n      $(pages[0]).removeClass('hidden');\n      trig++;\n      setTimeout(function() {\n        scrollController();\n      }, 1000);\n    }\n  }\n}\n\nvar fpBackgroundController = function() {\n  var bgContainer = $('body').find('.bg-container'),\n      firstImg = $(bgContainer).find('img'),\n      index;\n\n  if ( !bgContainer ) {\n    return;\n  }\n\n  if ( firstImg && firstImg[0] ) {\n    if (firstImg[0].complete) {\n      imagesHandler();\n    } else {\n      firstImg.load(imagesHandler);\n    }\n  }\n\n  function imagesHandler() {\n    setIndex(1);\n    $(firstImg).velocity({\n      'opacity': 1\n    }, {duration: 500, delay: 0, display: 'block', easing: [.24,.63,.5,.99]});\n\n    for( var i = 2; i < 7; i++ ) {\n      var img = $('<img />').attr('src', site.theme_path + '/img/bg/bg' + i + '.png').attr('class', 'bg-' + i);\n      $(bgContainer).append(img);\n    }\n\n    setTimeout(controller, 8000);\n  }\n\n  function controller() {\n    var j = getIndex(),\n        k = j+1;\n\n    if ( k > 6 ) {\n      k = 1;\n    }\n\n    var curImg = $(bgContainer).find('img.bg-' + j),\n        newImg = $(bgContainer).find('img.bg-' + k);\n\n    animateIn(newImg);\n    animateOut(curImg);\n\n    setIndex(k);\n\n    setTimeout(controller, 4000);\n  }\n\n  function animateIn(image) {\n    $(image).velocity({\n      'opacity': 1\n    }, {duration: 1000, delay: 0, display: 'block', easing: [.24,.63,.5,.99]});\n  }\n\n  function animateOut(image) {\n    $(image).velocity({\n      'opacity': 0\n    }, {duration: 1000, delay: 0, display: 'block', easing: [.24,.63,.5,.99]});\n  }\n\n  function getIndex() {\n    n = index;\n    return n;\n  }\n\n  function setIndex(newIndex) {\n    index = newIndex;\n  }\n}\n\nvar fpVideoController = function() {\n  var vid = document.getElementById('frontpage-video');\n\n  if (!vid) {\n    return;\n  } else {\n    var spinner = $('body').find('.spinner'),\n        container = $('body').find('.front-video-container'),\n        vidElement = $(container).find('#frontpage-video'),\n        movingContent = $('body').find('.moving-content'),\n        width = $(window).width(),\n        vidHeight = ((width/100*80)/16)*9;\n\n    addEventListeners();\n  }\n\n  function addEventListeners() {\n    vid.addEventListener('canplaythrough', animShowVideo);\n    vid.addEventListener('ended', animOutVideo);\n  }\n\n  function animShowVideo() {\n    $(spinner).addClass('hidden');\n\n    $(container).velocity({\n      'height': vidHeight\n    }, {duration: 700, delay: 0, easing: [.24,.63,.5,.99]});\n\n    $(vidElement).velocity({\n      'opacity': 1\n    }, {duration: 700, delay: 0, display: 'block', easing: [.24,.63,.5,.99]});\n\n    $(movingContent).velocity({\n      'top': vidHeight + 30\n    }, {duration: 700, delay: 0, display: 'block', easing: [.24,.63,.5,.99]});\n\n    setTimeout(function() {\n      if ( vid.paused ) {\n        vid.play();\n      }\n    }, 700);\n  }\n\n  function animOutVideo() {\n    $(vidElement).velocity({\n      'opacity': 0\n    }, {duration: 300, delay: 0, display: 'block', easing: [.24,.63,.5,.99]});\n\n    $(container).velocity({\n      'height': 60\n    }, {duration: 1000, delay: 400, easing: [.24,.63,.5,.99]});\n\n    $(movingContent).velocity({\n      'top': 90\n    }, {duration: 1000, delay: 400, display: 'block', easing: [.24,.63,.5,.99]});\n\n    scrollTo(0);\n  }\n}\n\n\nvar scrollHeaderController = function() {\n  var linkHeader = $('body').find('.header-link-row'),\n      width = $(window).width(),\n      scroll;\n\n  $(window).on('scroll', modifyHeader);\n\n  function modifyHeader() {\n    scroll = $(window).scrollTop();\n\n    if ( scroll > 500 ) {\n      $(linkHeader).addClass('hidden');\n    }\n    if ( scroll < 500 ) {\n      $(linkHeader).removeClass('hidden');\n    }\n  }\n}\n\nfunction validateEmail(email) {\n  var regex = /^(([^<>()[\\]\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/i;\n  return regex.test(email);\n}\n\nfunction validateInput(input) {\n  var allowedChars = /^[\\u00C0-\\u1FFF\\u2C00-\\uD7FF\\w&.,\\- ]+$/;\n  return allowedChars.test(input);\n}\n\nfunction validateNumber(input) {\n  var isNumber = /^(?=.*[0-9])[+()0-9]+$/;\n  return isNumber.test(input);\n}\n\nvar reserveFormController = function() {\n  var form = $('body').find('form.reserve'),\n      emailInput = $(form).find('input[type=email]'),\n      nameInput = $(form).find('input[type=text].name'),\n      phoneInput = $(form).find('input[type=text].phone'),\n      submitBtn = $(form).find('.submit-btn > a');\n\n  function validateEmailOnBlur() {\n    $(emailInput).on('blur', function() {\n      var value = $(this).val();\n\n      if ( value.length === 0 ) {\n        if ( $(this).hasClass('error') ) {\n          $(this).removeClass('error');\n        }\n        return;\n      }\n\n      if ( value.length !== 0 ) {\n        var isEmail = validateEmail(value);\n\n        if( !isEmail && !$(this).hasClass('error') ) {\n          $(this).addClass('error');\n        }\n\n        if( isEmail && $(this).hasClass('error') ) {\n          $(this).removeClass('error');\n        }\n      }\n    });\n  }\n\n  function validateNameOnBlur() {\n    $(nameInput).on('blur', function() {\n      var value = $(this).val();\n\n      if ( value.length === 0 ) {\n        if ( $(this).hasClass('error') ) {\n          $(this).removeClass('error');\n        }\n        return;\n      }\n\n      if ( value.length !== 0 ) {\n        var isTrustedCharacters = validateInput(value);\n\n        if( !isTrustedCharacters && !$(this).hasClass('error') ) {\n          $(this).addClass('error');\n        }\n\n        if( isTrustedCharacters && $(this).hasClass('error') ) {\n          $(this).removeClass('error');\n        }\n      }\n    });\n  }\n\n  function validateNumberOnBlur() {\n    $(phoneInput).on('blur', function() {\n      var value = $(this).val();\n\n      if ( value.length === 0 ) {\n        if ( $(this).hasClass('error') ) {\n          $(this).removeClass('error');\n        }\n        return;\n      }\n\n      if ( value.length !== 0 ) {\n        var isNumber = validateNumber(value);\n\n        if ( !isNumber && !$(this).hasClass('error') ) {\n          $(this).addClass('error');\n        }\n\n        if ( isNumber && $(this).hasClass('error') ) {\n          $(this).removeClass('error');\n        }\n      }\n    });\n  }\n\n  function submitListener() {\n    $(submitBtn).on('click', function(event) {\n      event.preventDefault(),\n      inputs = $(form).find('input'),\n      validSuccess = $('body').find('.validation.success');\n      dataObject = {},\n      inputArray = [];\n\n      $(inputs).each(function(i, e) {\n        if ( $(e).hasClass('error') || $(e).val().length === 0 ) {\n          return;\n        } else {\n          var object = {\n            name: e.name,\n            value: $(e).val()\n          }\n          inputArray.push(object);\n        }\n      });\n\n      var data = packData();\n      sendForm(data);\n    });\n\n    function packData() {\n      dataObject.customer_html = '<h4>Navn:</h4><h2>' + inputArray[0].value + '</h2>';\n      dataObject.customer_html += '<h4>TLF:</h4><h2>' + inputArray[1].value + '</h2>';\n      dataObject.customer_html += '<h4>EMAIL:</h4><h2>' + inputArray[2].value + '</h2>';\n      dataObject.customer_email = inputArray[2].value;\n\n      return dataObject;\n    }\n\n    function sendForm(data) {\n      var customerData = JSON.stringify(data);\n\n        $.ajax({\n          url: site.ajax_url + '?action=reserve',\n          type: 'POST',\n          data: customerData,\n          success: function(response) {\n            var stripResponse = $.trim(response);\n            console.log(stripResponse);\n            if ( stripResponse === 'Success' ) {\n              animateSuccess();\n            }\n            if ( stripResponse === 'Error' ) {\n\n            }\n          },\n          error: function(response) {\n            console.log(response);\n          }\n        });\n    }\n\n    function animateSuccess() {\n      $(form).velocity({\n        'opacity': [0, 1]\n      }, {duration: 300, delay: 0, easing: [.24,.63,.5,.99], display: 'none'});\n\n      $(validSuccess).velocity({\n        'opacity': [1, 0]\n      }, {duration: 300, delay: 350, easing: [.24,.63,.5,.99], display: 'block'});\n\n      setTimeout(function() {\n        window.location.href = window.location.href;\n      }, 1000);\n    }\n  }\n\n  validateNumberOnBlur();\n  validateEmailOnBlur();\n  validateNameOnBlur();\n  submitListener();\n}\n\n\nfunction shopMsg(title, msg) {\n  var atcModal = $('body').find('.atc-modal');\n\n  if ( !msg ) {\n    var msg = '<span>- blev tilføjet til kurven.</span>';\n  } else {\n    var msg = msg;\n  }\n\n  var html = '<h3>' + title + '</h3>' + msg;\n\n  $(atcModal).append(html);\n\n  function animate() {\n    $(atcModal).velocity({\n      'opacity': [1, 0],\n      'top': [150, 300],\n      'z-index': [999999999998, 999999999998]\n    }, {duration: 400, delay: 0, easing: 'easeInOutSine'});\n\n    $(atcModal).velocity({\n      'opacity': [0, 1],\n      'top': [300, 150],\n      'z-index': [999999999998, 99999999998]\n    }, {duration: 400, delay: 1400, easing: 'easeInOutSine'});\n  }\n\n  setTimeout(function() {\n    animate();\n  }, 100);\n\n  setTimeout(function() {\n    $(atcModal).html('');\n    $(atcModal).css({\n      'z-index': -1000\n    });\n  }, 2500);\n}\n\n\nvar productTextController = function() {\n  var textIcon = $('body').find('.text-icon'),\n      productLeft = $('body').find('.product-left'),\n      productRight = $('body').find('.product-right');\n\n  $(textIcon).on('click', function() {\n    toggleClass();\n  });\n\n  function toggleClass() {\n    $(textIcon).toggleClass('off');\n    $(productLeft).toggleClass('off');\n    $(productRight).toggleClass('off');\n  }\n\n  setTimeout(toggleClass, 800);\n}\n\nvar singleProductHeightController = function() {\n  var mainImage = $('.main-image img'),\n      iFrame = $('body').find('iframe');\n\n  if ( mainImage && mainImage[0] ) {\n    if (mainImage[0].complete) {\n      handler();\n    } else {\n      mainImage.load(handler);\n    }\n  } else {\n    return;\n  }\n\n  function handler() {\n    var contentHeight = $('.product-content').height(),\n        imageHeight = $('.main-image img').height();\n\n    if ( contentHeight && imageHeight < contentHeight ) {\n      $('.main-image').css({\n        'height': contentHeight + 'px'\n      });\n    } else {\n      return;\n    }\n    setMenuHeight();\n  }\n}\n\nvar embedVidController = function() {\n  var vidFrame = $('body').find('.youtube-frame');\n\n  if ( vidFrame.length > 0 ) {\n    initVideo();\n  } else {\n    return;\n  }\n\n  function initVideo() {\n    var vidUrl = $(vidFrame).attr('data-href');\n        if ( vidUrl.indexOf('=') !== -1 ) {\n          var vidId = vidUrl.split('='),\n              id = vidId[1];\n        } else {\n          var vidId = vidUrl.split('/');\n          id = vidId[3];\n        }\n\n    var width = $(window).width(),\n        height = (((width/100)*90) / 16) * 9;\n\n    var constructedHtml = '<iframe width=\"' + width + '\" height=\"' + height + '\" src=\"https://www.youtube.com/embed/' + id + '?rel=0&amp;showinfo=0\" frameborder=\"0\" allowfullscreen></iframe>';\n\n    $(vidFrame).html(constructedHtml);\n  }\n};\n\n\nvar gridCartController = function() {\n  var addBtn = $('body').find('.add-button'),\n      cart = $('body').find('.cart-contents');\n\n  $(addBtn).each(function(i, e) {\n    var id = $(this).attr('data-href'),\n        prodTitle = $(this).attr('data-title');\n\n    $(this).on('click', function(event) {\n      console.log('clicked');\n      event.preventDefault();\n      var cartNumber = $('body').find('.cart-icon h5'),\n          cartInt = parseInt($('body').find('.cart-icon h5').text()),\n          url = site.ajax_url + '?action=sinus_add',\n          dataObject = {\n            'product_id': id\n          }\n\n      data = JSON.stringify(dataObject);\n\n      $.ajax({\n        url: url,\n        type: 'POST',\n        data: data,\n        dataType: 'html',\n        success: function(response) {\n          var updatedNum = cartInt + 1;\n          cartNumber.html(updatedNum);\n          $(cart).html(response);\n          shopMsg(prodTitle);\n\n          setTimeout(function() {\n            window.location.href = window.location.href;\n          }, 1000);\n        },\n        error: function(response) {\n          console.log('error -', response);\n        }\n      });\n    });\n  });\n};\n\nvar removeFromCartController = function() {\n    var cart = $('body').find('.cart-contents'),\n        remBtn = $(cart).find('.remove-icon');\n\n  $(remBtn).each(function(i, e) {\n    var id = $(this).attr('data-id'),\n        qtyElem = $(this).siblings('.elem-qty-total'),\n        qty = parseInt($(qtyElem).attr('data-qty'));\n\n\n    $(this).on('click', function() {\n      console.log(qty, id);\n      var cartNumber = $('body').find('.cart-icon h5'),\n          cartInt = parseInt($('body').find('.cart-icon h5').text()),\n          url = site.ajax_url + '?action=sinus_remove',\n          dataObject = {\n            'product_id': id,\n            'quantity': qty\n          }\n\n      data = JSON.stringify(dataObject);\n\n      $.ajax({\n        url: url,\n        type: 'POST',\n        data: data,\n        dataType: 'html',\n        success: function(response) {\n          var updatedNum = cartInt - qty;\n          cartNumber.html(updatedNum);\n          $(cart).html(response);\n          window.location.href = window.location.href;\n        },\n        error: function(response) {\n          console.log('error -', response);\n        }\n      });\n    });\n  });\n};\n\nfunction setMenuHeight() {\n  setTimeout(function() {\n    var mainMenu = $('body').find('.main-menu'),\n        siteContent = $('body').find('.site-content'),\n        documentHeight = $('.site-content').height();\n\n     // set menu height, relative to content height (minus footer)\n    $(mainMenu).css({\n      'height': documentHeight - 325 + 'px'\n    });\n  }, 1000);\n}\n\nvar MenuController = function() {\n  var menuBtn = $('body').find('.menu-icon'),\n      mainMenu = $('body').find('.main-menu'),\n      menuLinks = $(mainMenu).find('li'),\n      menuHeaders = $(mainMenu).find('h3'),\n      searchForm = $('body').find('.search-form'),\n      cartIcon = $('body').find('.cart-icon'),\n      cartContents = $('body').find('.cart-modal.cart-contents'),\n      width = $(window).width();\n      setMenuHeight();\n\n      $(menuBtn).on('click', animateMenu);\n\n      function animateMenu() {\n        if ( $(mainMenu).hasClass('hidden') ) {\n          $(mainMenu).removeClass('hidden');\n          $(this).addClass('open');\n          scrollTo('0px');\n          updateHeaderOpen();\n          addEventListener();\n        } else {\n          $(mainMenu).addClass('hidden');\n          $(this).removeClass('open');\n          updateHeaderClose();\n        }\n      }\n\n\n      function updateHeaderOpen() {\n        var rawIconCss = $(cartIcon).css('right'),\n            rawSearchCss = $(searchForm).css('right'),\n            rawCartContCss = $(cartContents).css('right'),\n            iconRight = parseInt(rawIconCss.replace('px', '')),\n            searchRight = parseInt(rawSearchCss.replace('px', '')),\n            cartContRight = parseInt(rawCartContCss.replace('px', ''));\n\n\n            $(cartIcon).velocity({\n              'right': iconRight + 230 + 'px'\n            }, {duration: 400, delay: 100, easing: [.24,.63,.5,.99]});\n\n            $(searchForm).velocity({\n              'right': searchRight + 230 + 'px'\n            }, {duration: 400, delay: 0, easing: [.24,.63,.5,.99]});\n\n            $(cartContents).velocity({\n              'right': cartContRight + 230 + 'px'\n            }, {duration: 400, delay: 150, easing: [.24,.63,.5,.99]});\n      }\n\n      function updateHeaderClose() {\n            $(cartIcon).velocity({\n              'right': 90\n            }, {duration: 300, delay: 200, easing: [.24,.63,.5,.99]});\n\n            $(searchForm).velocity({\n              'right': 165\n            }, {duration: 300, delay: 300, easing: [.24,.63,.5,.99]});\n\n            $(cartContents).velocity({\n              'right': 80\n            }, {duration: 300, delay: 250, easing: [.24,.63,.5,.99]});\n      }\n\n      function addEventListener() {\n        $(menuLinks).on('click', function(e) {\n          e.preventDefault();\n          var aHref =  $(this).find('a');\n          var href = $(aHref).attr('href');\n\n          $(menuLinks).each(function(i, elem) {\n            var delay = i * 20;\n\n            $(elem).velocity({\n              'opacity': [0, 1]\n            }, {duration: 100, delay: delay, easing: 'easeInOutSine'});\n\n          });\n\n          $(menuHeaders).each(function(i, elem) {\n            var delay = i * 30;\n\n            $(elem).velocity({\n              'opacity': [0, 1]\n            }, {duration: 100, delay: delay, easing: 'easeInOutSine'});\n          });\n\n          setTimeout(navigate(href), 1200);\n        });\n      }\n\n      function navigate(href) {\n        setTimeout(function() {\n          $(menuBtn).removeClass('open');\n          $(mainMenu).addClass('hidden');\n          updateHeaderClose();\n        }, 1000);\n\n        setTimeout(function() {\n          window.location.href = href;\n        }, 1300);\n      }\n};\n\nvar CartController = function() {\n  var cartIcon = $('body').find('.cart-icon'),\n      headerLinkRow = $('body').find('.header-link-row'),\n      cartContents = $('body').find('.cart-modal.cart-contents.hidden');\n\n  $(cartIcon).on('click', function(e) {\n    if ( headerLinkRow.hasClass('hidden') ) {\n      $(cartContents).css({\n        'top': 65 + 'px'\n      });\n    } else {\n      $(cartContents).css({\n        'top': 95 + 'px'\n      });\n    }\n    $(cartContents).toggleClass('hidden');\n  });\n}\n\n\n// http://sin.us/wp-json/posts?type=product&filter[product_cat]=hifi&filter[orderby]=price&filter[order]=asc\n\n"],"sourceRoot":"/source/"}