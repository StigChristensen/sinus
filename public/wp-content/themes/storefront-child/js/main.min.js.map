{"version":3,"sources":["main.js"],"names":["scrollTo","value","$","animate","scrollTop","show404","type","animateIn","elem","spinner","hasClass","addClass","removeClass","animateOut","container","find","message","html404","html","css","margin-bottom","setTimeout","mess","productsController","promise","productsSupplyer","then","products","render","sortPriceController","urlListener","getSearchParams","hash","parts","split","getParams","searchParams","searchController","href","window","location","indexOf","brands","search","console","log","sortHash","onhashchange","event","searchFormController","form","input","on","preventDefault","val","length","attr","replace","encoded","encodeURI","setUrl","decodedParams","each","i","e","p","decodeURIComponent","par","push","getSearchProducts","returnSortedSearch","params","sort","sortByFrequency","array","frequency","forEach","uniques","filter","a","b","cats","categories","tags","title","desc","description","stripped","toLowerCase","lowerCats","lowerTags","sorted","getTopHits","uniq","_","defer","resolve","Deferred","newProductsPromise","newProducts","price","param","paramtype","splitHash","splitParams","newDirection","pAsc","pDesc","sortUrl","pri","pt","base_url","h","hashBase","paramArray","base","getParam","cat","string","paramsLength","urlDataController","undefined","dataPromise","returnSortedPriceLow","done","fail","returnSortedPriceHigh","returnSortedCat","returnSortedBrand","returnSortedMultiple","getFirstList","getFirst","init","sortedPrice","reject","getSecondList","getSecond","firstPromise","finalSort","brandSorted","catSorted","sortdef","when","data","sortPrice","initArray","object","parseInt","element","initialSort","j","f","reverse","storageAvailable","storage","x","setItem","removeItem","setPageIndex","index","pageIndex","getPageIndex","setMaxPages","max","maxPages","setQueryType","urlSearch","query","urlType","url","urlBrands","urlProducts","getQueryType","initialize","queryParams","key","productsCache","localStorage","JSON","parse","getItem","def","getPosts","action","queryType","offset","limit","dataObj","stringify","ajax","site","ajax_url","dataType","success","response","error","loop","loopDef","k","getTemplate","setTemplate","template","ti","te","ci","ce","grid","pages","pi","pe","remove","loopPromise","append","sortTags","scrollController","setMenuHeight","page","gridCartController","modalController","prepare","stock_quantity","stockIcon","id","featured_src","price_html","splice","join","tempDefer","catHtml","brandHtml","menuLeft","categoryContainer","brandContainer","pCat","pBrand","brand","sortController","delay","velocity","opacity","duration","display","easing","detach","initDirection","setDirection","dir","direction","getDirection","priceSorter","currentDir","updateView","trig","content","windowHeight","height","scroll","document","requestAnimationFrame","validateEmail","email","regex","test","validateInput","allowedChars","validateNumber","isNumber","shopMsg","msg","atcModal","top","z-index","mainMenu","documentHeight","jQuery","CartController","MenuController","removeFromCartController","reserveFormController","scrollHeaderController","embedVidController","fpVideoController","fpBackgroundController","focus","this","blur","modalRender","addEventListeners","modalOverlay","modalClose","get_content","contentDef","dataObject","modal","prods","clickArea","prod_id","getData","imagesHandler","setIndex","firstImg","img","theme_path","bgContainer","controller","getIndex","curImg","newImg","image","n","newIndex","complete","load","vid","addEventListener","animShowVideo","animOutVideo","vidHeight","vidElement","movingContent","paused","play","getElementById","width","modifyHeader","linkHeader","validateEmailOnBlur","emailInput","isEmail","validateNameOnBlur","nameInput","isTrustedCharacters","validateNumberOnBlur","phoneInput","submitListener","packData","customer_html","inputArray","customer_email","sendForm","customerData","stripResponse","trim","animateSuccess","validSuccess","submitBtn","inputs","name","productTextController","toggleClass","textIcon","productLeft","productRight","singleProductHeightController","handler","contentHeight","imageHeight","mainImage","initVideo","vidUrl","vidFrame","vidId","constructedHtml","addBtn","cart","prodTitle","cartNumber","cartInt","text","product_id","updatedNum","remBtn","qtyElem","siblings","qty","quantity","animateMenu","updateHeaderOpen","updateHeaderClose","rawIconCss","cartIcon","rawSearchCss","searchForm","rawCartContCss","cartContents","iconRight","searchRight","cartContRight","right","menuLinks","aHref","menuHeaders","navigate","menuBtn","headerLinkRow"],"mappings":"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","file":"main.min.js","sourcesContent":["// Test if ie10 - adds class \"ie10\" to HTML tag, if true. - Excludes IE11\nif (/*@cc_on!@*/false && document.documentMode === 10) {\n    document.documentElement.className+=' ie10';\n}\n\njQuery(document).on('ready', function() {\n  $ = jQuery;\n\n  new CartController();\n  new MenuController();\n  new removeFromCartController();\n  new gridCartController();\n  new reserveFormController();\n  new scrollHeaderController();\n  new embedVidController();\n  new fpVideoController();\n  new fpBackgroundController();\n  urlListener();\n  searchFormController();\n\n  // labels for input fields\n  $(\"form :input\").focus(function() {\n    $(\"label[for='\" + this.id + \"']\").addClass(\"focus\");\n  }).blur(function() {\n    $(\"label\").removeClass(\"focus\");\n  });\n}); // End Ready\n\nvar documentHeight;\n\nfunction scrollTo(value) {\n  $('html, body').animate({\n    scrollTop: value\n  }, 700);\n}\n\nfunction show404(type) {\n  var container = $('body').find('.product-list-grid'),\n      spinner = $('body').find('.spinner');\n      html404;\n\n  if ( type === 'search' ) {\n    var message = 'Der er desværre ingen resultater, der matcher det du søger efter.';\n    var html404 = '<div class=\"contained-404 hidden\"><h3>' + message + '</h3></div>';\n    $(container).html(html404);\n\n    $(container).css({\n        'margin-bottom': 0\n      });\n\n    setTimeout(function() {\n      var mess = $(container).find('.contained-404');\n      animateIn(mess);\n    }, 200);\n  }\n\n  if ( type === 'remove' ) {\n    var mess = $(container).find('.contained-404');\n    if ( mess && !$(mess).hasClass('hidden') ) {\n      $(container).css({\n          'margin-bottom': 100\n        });\n\n      setTimeout(function() {\n\n        animateOut(mess);\n      }, 200);\n    }\n  }\n\n  function animateIn(elem) {\n    if ( !$(spinner).hasClass('hidden') ) {\n      $(spinner).addClass('hidden');\n    }\n    $(elem).removeClass('hidden');\n  }\n\n  function animateOut(elem) {\n    // $(spinner).reClass('hidden');\n    $(elem).addClass('hidden');\n  }\n}\n\nvar modalController = function() {\n  var prods = $('body').find('li.product'),\n      modal = $('body').find('.product-modal'),\n      content = $(modal).find('.modal-content');\n      modalOverlay = $('body').find('.product-modal-overlay'),\n      modalClose = $(modal).find('.modal-close-btn');\n\n  $(prods).each(function(i,e) {\n    var clickArea = $(e).find('.click-area');\n\n    $(clickArea).on('click', function(event) {\n      var prod_id = $(e).data('singleid');\n      event.preventDefault();\n\n      var getData = get_content(prod_id);\n\n      getData.done(function(data) {\n        modalRender(data, modal);\n      })\n      .fail(function() {\n        return;\n      });\n    });\n  });\n\n  function modalRender(data) {\n    $(content).html(data);\n\n    setTimeout(function() {\n      new embedVidController();\n      new gridCartController();\n      addEventListeners();\n      animateIn();\n    }, 200);\n  }\n\n  function addEventListeners() {\n    $(modalOverlay).on('click', function() {\n      animateOut();\n    });\n\n    $(modalClose).on('click', function() {\n      animateOut();\n    });\n  }\n\n  function get_content(id) {\n    var contentDef = $.Deferred(),\n        id = id;\n        url = site.ajax_url + '?action=sinus_getsinglehtml',\n        dataObject = {\n          id: id\n        }\n\n    var data = JSON.stringify(dataObject);\n\n    $.ajax({\n      url: url,\n      type: \"POST\",\n      data: data,\n      success: function(response) {\n        contentDef.resolve(response);\n      },\n      error: function(response) {\n        contentDef.reject(response);\n      }\n    });\n    return contentDef;\n  }\n\n  function animateIn() {\n    $(modal).removeClass('hidden');\n    $(modalOverlay).removeClass('hidden');\n  }\n\n  function animateOut() {\n    $(modal).addClass('hidden');\n    $(modalOverlay).addClass('hidden');\n  }\n\n}\n\nfunction productsController() {\n  var promise = productsSupplyer();\n  promise.then(function(products) {\n    render(products);\n  });\n  sortPriceController('asc');\n}\n\nfunction urlListener() {\n  var href = window.location.href,\n      hash = window.location.hash,\n      type = href.indexOf('/type/'),\n      brands = href.indexOf('/brands/'),\n      search = href.indexOf('#s='),\n      initParams,\n      base_url;\n\n  if ( type === -1 && brands === -1 && search === -1 ) {\n    return;\n  } else {\n    if ( !hash ) {\n        productsController();\n    } else {\n      if ( search !== -1 ) {\n        getSearchParams(hash);\n      } else {\n        console.log(search);\n        sortHash(hash);\n      }\n    }\n  }\n\n  window.onhashchange = function(event) {\n    hash = window.location.hash;\n    search = hash.indexOf('#s=');\n\n    if ( search !== -1 ) {\n      getSearchParams(hash);\n    } else {\n      sortHash(hash);\n    }\n  }\n\n  function getSearchParams(hash) {\n    var parts = hash.split('#s=');\n\n    var getParams = parts[1].split('&');\n    var searchParams = getParams[0].split('+');\n    searchController(searchParams);\n  }\n}\n\nfunction searchFormController() {\n  var form = $('body').find('form.sinus-search'),\n      input = $(form).find('input[type=text]');\n\n  $(form).on('submit', function(event) {\n    event.preventDefault();\n    var val = $(input).val();\n\n    if ( val.length < 1 ) {\n      $(input).attr('placeholder', 'Mindst 3 tegn...');\n      return;\n    }\n\n    if ( val.length > 1 ) {\n      if ( val.indexOf(' ') !== -1 ) {\n        val.replace(' ', '+');\n      }\n\n      var encoded = encodeURI(val);\n      var hash = '#s=' + encoded;\n\n      setUrl(hash);\n    }\n  });\n}\n\nfunction searchController(searchParams) {\n  if ( searchParams ) {\n    var decodedParams = [];\n    $(searchParams).each(function(i,e) {\n      var p = decodeURIComponent(e);\n\n        if ( p.indexOf(' ') !== -1 ) {\n          var split = p.split(' ');\n          $(split).each(function(i, par) {\n            decodedParams.push(par);\n          });\n        } else {\n          decodedParams.push(p);\n        }\n    });\n\n    var getSearchProducts = returnSortedSearch(decodedParams);\n\n    getSearchProducts.then(function(products) {\n      render(products);\n    });\n\n  } else {\n    return;\n  }\n}\n\nfunction returnSortedSearch(params, products) {\n  var sorted = [],\n      defer = $.Deferred();\n\n  if ( !products ) {\n    var newProductsPromise = productsSupplyer();\n    newProductsPromise.then(function(newProducts) {\n      var results = sort(newProducts);\n    });\n  } else {\n    sort(products);\n  }\n\n  function sort(products) {\n    $(products).each(function(i,e) {\n      var cats = e.categories,\n          tags = e.tags,\n          title = e.title,\n          desc = e.description,\n          stripped = desc.replace(/<(?:.|\\n)*?>/gm, '').toLowerCase(),\n          lowerCats = [],\n          lowerTags = [];\n\n      var lowerTitle = title.toLowerCase();\n      var lowerDesc = desc.toLowerCase();\n\n      $(cats).each(function(i, a) {\n        var b = a.toLowerCase();\n        lowerCats.push(b);\n      });\n\n      $(tags).each(function(i, a) {\n        var b = a.toLowerCase();\n        lowerTags.push(b);\n      });\n\n\n      for (var i = 0; i < params.length; i++) {\n        par = params[i].toLowerCase();\n\n        if ( lowerCats.indexOf(par) !== -1 ) {\n          sorted.push(e);\n        }\n\n        if ( lowerTags.indexOf(par) !== -1 ) {\n          sorted.push(e);\n        }\n\n        if ( title.indexOf(par) !== -1 ) {\n          sorted.push(e);\n        }\n\n        if ( stripped.indexOf(par) !== -1 ) {\n          sorted.push(e);\n        }\n      }\n\n    });\n\n    function sortByFrequency(array) {\n      var frequency = {};\n\n      array.forEach(function(value) { frequency[value] = 0; });\n\n      var uniques = array.filter(function(value) {\n          return ++frequency[value] == 1;\n      });\n\n      return uniques.sort(function(a, b) {\n          return frequency[b] - frequency[a];\n      });\n    }\n\n    var getTopHits = sorted.sort(sortByFrequency(sorted));\n\n    var uniq = _.uniq(getTopHits, true);\n\n    defer.resolve(uniq);\n  }\n\n  return defer;\n}\n\nfunction sortHash(hash) {\n  var price, param, paramtype, splitHash, splitParams, newDirection;\n\n  if ( hash.indexOf('#s=') !== -1 ) {\n    return;\n  }\n\n  if ( hash.indexOf('price_asc') !== -1 ) {\n    price = 'price_asc';\n    newDirection = 'price_desc';\n    sortPriceController(newDirection);\n  }\n\n  if ( hash.indexOf('price_desc') !== -1 ) {\n    price = 'price_desc';\n    newDirection = 'price_asc';\n    sortPriceController(newDirection);\n  }\n\n  if ( hash.indexOf('category') !== -1 ) {\n    paramtype = 'category';\n  }\n\n  if ( hash.indexOf('brand') !== -1 ) {\n    paramtype = 'brand';\n  }\n\n  if ( paramtype ) {\n    splitHash = hash.split('=');\n    splitParams = splitHash[1].split('+');\n    var pAsc = splitParams.indexOf('price_asc');\n    var pDesc = splitParams.indexOf('price_desc');\n\n    if ( pAsc === 0 || pDesc === 0 ) {\n      param = splitParams[2];\n    } else {\n      param = splitParams[1];\n    }\n  }\n\n  console.log(price, paramtype, param);\n\n  sortUrl(price, param, paramtype);\n}\n\nfunction sortUrl(price, param, paramtype) {\n  var h = window.location.hash,\n      href = window.location.href,\n      pri, par, pt,\n      hashBase = '#sort=',\n      paramArray = [],\n      base_url;\n\n  if ( h ) {\n    var base = href.split('#');\n    base_url = base[0];\n\n    if ( price ) {\n      pri = price;\n      paramArray.push(pri);\n    } else {\n      if ( h.indexOf('price_asc') !== -1 ) {\n        pri = 'price_asc';\n        paramArray.push(pri);\n      }\n      if ( h.indexOf('price_desc') !== -1 ) {\n        pri = 'price_desc';\n        paramArray.push(pri);\n      }\n    }\n\n    if ( param ) {\n      par = param;\n      pt = paramtype;\n      paramArray.push(pt);\n      paramArray.push(par);\n    } else {\n      if ( h.indexOf('category') !== -1 ) {\n        paramtype = 'category';\n        var getParam = h.split('category');\n        var cat = getParam[1].replace('+', '');\n        par = cat;\n        paramArray.push(paramtype);\n        paramArray.push(par);\n      }\n\n      if ( h.indexOf('brand') !== -1 ) {\n        paramtype = 'brand';\n        var getParam = h.split('brand');\n        var cat = getParam[1].replace('+', '');\n        par = cat;\n        paramArray.push(paramtype);\n        paramArray.push(par);\n      }\n    }\n\n  } else {\n    base_url = href;\n\n    if ( price ) {\n      pri = price;\n      paramArray.push(pri);\n    }\n\n    if ( param ) {\n      par = param;\n      pt = paramtype;\n      paramArray.push(pt);\n      paramArray.push(par);\n    }\n  }\n\n  var string = '';\n      string = hashBase;\n\n  var paramsLength = paramArray.length;\n  $(paramArray).each(function(i, e) {\n    if ( i < (paramsLength-1) ) {\n      string += e + '+';\n    }\n    if ( i === (paramsLength-1) ) {\n      string += e;\n    }\n  });\n\n  setUrl(string, base_url);\n  urlDataController(pri, par, pt);\n}\n\nfunction setUrl(hash, href) {\n  if ( !href ) {\n    window.location.hash = hash;\n  } else {\n    window.location.href = href + hash;\n  }\n}\n\nfunction urlDataController(price, param, paramtype) {\n  if ( price && param === undefined && param === undefined ) {\n\n    if ( price === 'price_asc' ) {\n      var dataPromise = returnSortedPriceLow();\n\n      dataPromise.done(function(products) {\n        render(products);\n      })\n      .fail(function() {\n          console.log('failed!');\n      });\n    }\n\n    if ( price === 'price_desc' ) {\n      var dataPromise = returnSortedPriceHigh();\n\n      dataPromise.done(function(products) {\n        render(products);\n      })\n      .fail(function() {\n          console.log('failed!');\n      });\n    }\n  }\n\n  if ( price === undefined && param && paramtype ) {\n    if ( paramtype === 'category' ) {\n      var dataPromise = returnSortedCat(param);\n\n      dataPromise.done(function(products) {\n        render(products);\n      })\n      .fail(function() {\n          console.log('failed!');\n      });\n    }\n\n    if ( paramtype === 'brand' ) {\n      var dataPromise = returnSortedBrand(param);\n\n      dataPromise.done(function(products) {\n        render(products);\n      })\n      .fail(function() {\n          console.log('failed!');\n      });\n    }\n  }\n\n  if ( price && param && paramtype) {\n    var dataPromise = returnSortedMultiple(price, param, paramtype);\n\n    dataPromise.done(function(products) {\n      render(products);\n    })\n    .fail(function() {\n        console.log('failed!');\n    });\n  }\n\n  sortPriceController();\n}\n\nfunction returnSortedMultiple(price, param, paramtype) {\n  var sortdef = $.Deferred();\n\n  function getFirstList() {\n    var getFirst = $.Deferred();\n\n    if ( price ) {\n      if ( price === 'price_asc' ) {\n        var init = returnSortedPriceLow();\n\n        init.then(function(sortedPrice) {\n          getFirst.resolve(sortedPrice);\n        });\n      }\n\n      if ( price === 'price_desc' ) {\n        var init = returnSortedPriceHigh();\n\n        init.then(function(sortedPrice) {\n          getFirst.resolve(sortedPrice);\n        });\n      }\n\n    } else {\n      getFirst.reject('first rejected');\n    }\n    return getFirst;\n  }\n\n  function getSecondList() {\n    var getSecond = $.Deferred();\n    var firstPromise = getFirstList();\n\n    firstPromise.then(function(sortedPrice) {\n      if ( sortedPrice ) {\n\n        if ( param ) {\n          if ( paramtype === 'brand' ) {\n            var finalSort = returnSortedBrand(param, sortedPrice);\n            finalSort.then(function(brandSorted) {\n              getSecond.resolve(brandSorted);\n            });\n          }\n\n          if ( paramtype === 'category' ) {\n            var finalSort = returnSortedCat(param, sortedPrice);\n            finalSort.then(function(catSorted) {\n              getSecond.resolve(catSorted);\n            });\n          }\n        } else {\n          getSecond.reject('rejected - no param', sortedPrice);\n        }\n      }\n\n      if ( !sortedPrice && param ) {\n        if ( paramtype === 'brand' ) {\n            var finalSort = returnSortedBrand(param);\n            finalSort.then(function(brandSorted) {\n              getSecond.resolve(brandSorted);\n            });\n          }\n\n          if ( paramtype === 'category' ) {\n            var finalSort = returnSortedCat(param);\n            finalSort.then(function(catSorted) {\n              getSecond.resolve(catSorted);\n            });\n          }\n      } else {\n        getSecond.reject('rejected !products && param');\n      }\n    });\n\n    return getSecond;\n  }\n\n  $.when( getSecondList() ).then(function(data) {\n    sortdef.resolve(data);\n  });\n\n  return sortdef;\n}\n\n\n\nfunction returnSortedCat(param, products) {\n  var sorted = [],\n      defer = $.Deferred();\n\n  if ( !products ) {\n    var newProductsPromise = productsSupplyer();\n\n    newProductsPromise.then(function(newProducts) {\n      $(newProducts).each(function(i,e) {\n        var cats = e.categories;\n        if ( cats.indexOf(param) !== -1 ) {\n          sorted.push(e);\n        }\n      });\n\n      defer.resolve(sorted);\n    });\n  } else {\n    function sort() {\n      $(products).each(function(i,e) {\n        var categories = e.categories;\n        if ( categories.indexOf(param) !== -1 ) {\n          sorted.push(e);\n        }\n      });\n\n      defer.resolve(sorted);\n    }\n\n    sort();\n  }\n\n  return defer;\n}\n\nfunction returnSortedBrand(param, products) {\n  var sorted = [];\n  var defer = $.Deferred();\n\n  if ( !products ) {\n    var newProductsPromise = productsSupplyer();\n\n    newProductsPromise.then(function(newProducts) {\n      $(newProducts).each(function(i,e) {\n        var brands = e.tags;\n        if ( brands.indexOf(param) !== -1 ) {\n          sorted.push(e);\n        }\n      });\n\n      defer.resolve(sorted);\n    });\n  } else {\n    function sort() {\n      $(products).each(function(i,e) {\n        var brands = e.tags;\n        if ( brands.indexOf(param) !== -1 ) {\n          sorted.push(e);\n        }\n      });\n\n      defer.resolve(sorted);\n    }\n\n    sort();\n  }\n\n  return defer;\n}\n\nfunction returnSortedPriceLow() {\n  var newProductsPromise = productsSupplyer(),\n      defer = $.Deferred();\n\n  newProductsPromise.then(function(newProducts) {\n    var initArray = [],\n        sorted = [];\n\n    $(newProducts).each(function(i,e) {\n      var object = {\n        price: parseInt(e['regular_price']),\n        element: e\n      }\n      initArray.push(object);\n    });\n\n    function sortPrice(a,b) {\n      return a.price - b.price;\n    }\n\n    var initialSort = initArray.sort(sortPrice);\n\n    $(initialSort).each(function(j,f) {\n      sorted.push(f.element);\n    });\n\n    defer.resolve(sorted);\n  });\n\n  return defer;\n}\n\nfunction returnSortedPriceHigh() {\n  var newProductsPromise = productsSupplyer(),\n      defer = $.Deferred();\n\n  newProductsPromise.then(function(newProducts) {\n    var initArray = [],\n        sorted = [];\n\n    $(newProducts).each(function(i,e) {\n      var object = {\n        price: parseInt(e['regular_price']),\n        element: e\n      }\n      initArray.push(object);\n    });\n\n    function sortPrice(a,b) {\n      return a.price - b.price;\n    }\n\n    var initialSort = initArray.sort(sortPrice).reverse();\n\n    $(initialSort).each(function(j,f) {\n      sorted.push(f.element);\n    });\n\n    defer.resolve(sorted);\n  });\n\n  return defer;\n}\n\n\nfunction productsSupplyer() {\n  var url = window.location.href;\n  var hash = window.location.hash;\n  var def = $.Deferred();\n  var urlType = url.indexOf('/type/'),\n      urlBrands = url.indexOf('/brands/'),\n      urlSearch = hash.indexOf('#s='),\n      urlProducts = url.indexOf('/products/');\n\n  if ( urlType === -1 && urlBrands === -1 && urlSearch === -1 && urlProducts === -1 ) {\n    console.log('Exited from productsModel');\n    return;\n  }\n\n  var productsCache,\n      products,\n      storage = storageAvailable('localStorage'),\n      target = $('body').find('.product-list-grid'),\n      pageIndex,\n      maxPages,\n      type,\n      brand,\n      key,\n      query = {};\n      tags = {\n        brands: [],\n        categories: []\n      };\n      initialize();\n\n  function storageAvailable(type) {\n    try {\n      var storage = window[type],\n        x = '__storage_test__';\n      storage.setItem(x, x);\n      storage.removeItem(x);\n      return true;\n    }\n    catch(e) {\n      return false;\n    }\n  }\n\n  function setPageIndex(index) {\n    pageIndex = index;\n  }\n\n  function getPageIndex() {\n    var p = pageIndex;\n    return p;\n  }\n\n  function setMaxPages(max) {\n    maxPages = max;\n  }\n\n  function getMaxPages() {\n    var p = maxPages;\n    return p;\n  }\n\n  function setQueryType() {\n    var parts;\n\n    if ( urlSearch !== -1 ) {\n      parts = [];\n\n      query = {\n        type: 'all',\n        param: 'null'\n      }\n    } else {\n\n      if ( urlType !== -1 ) {\n        parts = url.split('/');\n\n        query = {\n          type: 'type',\n          param: parts[4]\n        }\n      }\n\n      if ( urlBrands !== -1 ) {\n        parts = url.split('/');\n\n        query = {\n          type: 'brand',\n          param: parts[4]\n        }\n      }\n\n      if ( urlProducts !== -1 ) {\n        parts = [];\n\n        query = {\n          type: 'all',\n          param: 'null'\n        }\n      }\n\n    }\n\n  }\n\n  function getQueryType() {\n    return query;\n  }\n\n  function initialize() {\n    var container = $('body').find('.products-container'),\n        pageIndex = $(container).data('page'),\n        maxPages = $(container).data('maxpages'),\n        type = $(container).data('cat'),\n        brand = $(container).data('tag');\n        setQueryType();\n        setMaxPages(maxPages);\n\n    if ( !pageIndex || pageIndex > maxPages ) {\n      setPageIndex(1);\n    } else {\n      setPageIndex(pageIndex);\n    }\n\n    var int = getPageIndex();\n    var queryParams = getQueryType();\n    key = queryParams.type + '_' + queryParams.param;\n\n    if ( storage ) {\n      productsCache = localStorage,\n      products = JSON.parse(productsCache.getItem(key));\n      if (products) {\n        def.resolve(products);\n      } else {\n        getPosts();\n      }\n    } else {\n      // load something else, maybe\n      console.log('no localStorage for us');\n    }\n  }\n\n  function getPosts() {\n    var queryType = getQueryType(),\n        action,\n        type = queryType.type;\n\n    if ( type === 'type' ) {\n      action = '?action=sinus_type';\n    }\n    if ( type === 'brand' ) {\n      action = '?action=sinus_brand';\n    }\n\n    if ( type === 'all' ) {\n      action = '?action=sinus_products';\n    }\n\n    console.log(queryType);\n\n    console.log(type, queryType.param);\n    var queryParams = {\n        offset: 0,\n        limit: -1,\n        param: queryType.param\n    },\n    dataObj = JSON.stringify(queryParams);\n\n    $.ajax({\n      url: site.ajax_url + action,\n      type: \"POST\",\n      data: dataObj,\n      dataType: 'json',\n      success: function(response) {\n        products = response.products;\n        productsCache.setItem(key, JSON.stringify(products));\n        def.resolve(products);\n      },\n      error: function(response) {\n        console.log(response);\n      }\n    });\n  }\n\n  return def;\n}\n\nfunction render(products) {\n  if ( products.length > 0 ) {\n    show404('remove');\n  } else {\n    show404('search');\n    return;\n  }\n\n  var grid = $('body').find('.product-list-grid'),\n      spinner = $('body').find('.spinner'),\n      pages = $('body').find('.page.products'),\n      length = products.length;\n\n  if ( !$(spinner).hasClass('hidden') ) {\n    $(spinner).addClass('hidden');\n  }\n\n  if ( pages ) {\n    $(pages).each(function(pi,pe) {\n      $(pe).remove();\n    });\n  }\n\n  function loop() {\n    loopDef = $.Deferred();\n\n    var pageIndex = 1;\n    var html = '<div class=\"page products page-1 hidden\">';\n        html += '<ul class=\"products\">';\n\n    $(products).each(function(i, e) {\n      var k = i + 1;\n\n      var getTemplate = setTemplate(e);\n\n      getTemplate.then(function(template) {\n        html += template;\n      });\n\n      $(e.tags).each(function(ti, te) {\n        tags.brands.push(te);\n      });\n\n      $(e.categories).each(function(ci, ce) {\n        tags.categories.push(ce);\n      });\n\n      if ( k % 24 === 0 && i < length ) {\n        pageIndex++;\n        html += '</ul>';\n        html += '</div>';\n        html += '<div class=\"page products page-' + pageIndex + ' hidden\">';\n        html += '<ul class=\"products\">';\n      }\n    });\n\n    html += '</ul>';\n    html += '</div>';\n\n    loopDef.resolve(html);\n    return loopDef;\n  }\n\n  var loopPromise = loop();\n\n  loopPromise.then(function(html) {\n    $(grid).append(html);\n    sortTags(tags);\n    scrollController();\n    setMenuHeight();\n    var page = $('body').find('.page.page-1');\n    $(page).removeClass('hidden');\n    setTimeout(function() {\n      new gridCartController();\n      new modalController();\n    }, 1500);\n  });\n\n}\n\n\nfunction setTemplate(e) {\n  var stockIcon, template;\n      tempDefer = $.Deferred();\n\n  function prepare() {\n    if ( e.stock_quantity === 0 ) {\n      stockIcon = '<div class=\"in-stock-icon\"><span>PÅ LAGER: <i class=\"fa fa-minus-square\"></i></span></div>';\n    }\n\n    if ( e.stock_quantity > 0 ) {\n      stockIcon = '<div class=\"in-stock-icon\"><span>PÅ LAGER: <i class=\"fa fa-check-square\"></i></span></div>';\n    }\n\n    var desc = e.description;\n    var stripped = desc.replace(/<(?:.|\\n)*?>/gm, '');\n\n    var template = '<li class=\"product\" itemscope itemtype=\"http://schema.org/Product\" data-singleid=\"' + e.id + '\">';\n        template += '<div class=\"click-area\"></div>';\n        template += stockIcon;\n        template += '<img src=\"' + e.featured_src + '\" alt=\"' + e.title + ' product image produkt billede Sinus-store Copenhagen København Denmark\" />';\n        template += '<div class=\"product-title\" itemprop=\"name\"><h3>' + e.title + '</h3></div>';\n        template += '<div class=\"product-price\">' + e.price_html + '<div class=\"add-button\" data-href=\"' + e.id + '\" data-title=\"' + e.title + '\"><svg version=\"1.1\" baseProfile=\"tiny\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"x=\"0px\" y=\"0px\" viewBox=\"0 0 60 60\" xml:space=\"preserve\"><line class=\"svg-line\" fill=\"none\" stroke=\"#007c96\" stroke-width=\"10\" stroke-miterlimit=\"10\" x1=\"30\" y1=\"6\" x2=\"30\" y2=\"54\"/><line class=\"svg-line\" fill=\"none\" stroke=\"#007c96\" stroke-width=\"10\" stroke-miterlimit=\"10\" x1=\"6\" y1=\"30\" x2=\"54\" y2=\"30\"/></svg><span class=\"add-info\">Tilføj til kurv</span></div></div>';\n        template += '<div class=\"sinus-product-info\"><div class=\"short-desc\" itemprop=\"description\"><p>' + desc.split(\" \").splice(0, 40).join(\" \") + '... </p><i class=\"fa fa-chevron-circle-up\"></i></div></div>';\n        template += '</li>';\n\n    tempDefer.resolve(template);\n  }\n\n  prepare();\n  return tempDefer;\n}\n\n\nfunction sortTags(tags) {\n  var menuLeft = $('body').find('.menu-left'),\n      categoryContainer = $(menuLeft).find('.categories'),\n      brandContainer = $(menuLeft).find('.brands'),\n      categories = _.uniq(tags.categories),\n      brands = _.uniq(tags.brands),\n      pCat = $(categoryContainer).find('p'),\n      pBrand = $(brandContainer).find('p'),\n      catHtml,\n      brandHtml;\n\n  if ( pCat.length !== 0 || pBrand.length !== 0 ) {\n    return\n  } else {\n    $(categories).each(function(i, cat) {\n      catHtml = '<p data-cat=\"' + cat + '\"><i class=\"fa fa-search-plus\"></i>' + cat + '</p>';\n      $(categoryContainer).append(catHtml);\n    });\n\n    $(brands).each(function(i, brand) {\n      brandHtml = '<p data-brand=\"' + brand + '\"><i class=\"fa fa-search-plus\"></i>' + brand + '</p>';\n      $(brandContainer).append(brandHtml);\n    });\n\n    setTimeout(function() {\n      sortController();\n    }, 1500);\n  }\n}\n\nfunction sortController() {\n  var menuLeft = $('body').find('.menu-left'),\n      categoryContainer = $(menuLeft).find('.categories'),\n      brandContainer = $(menuLeft).find('.brands'),\n      pCat = $(categoryContainer).find('p'),\n      pBrand = $(brandContainer).find('p'),\n      products = $('body').find('li.product'),\n      pages = $('body').find('.page.products'),\n      href = window.location.href;\n\n  $(pCat).each(function(i,e) {\n    var param = $(e).data('cat');\n\n    $(e).on('click', function() {\n      $(pages).each(function(i,e) {\n        var delay = 50 * i;\n        $(e).velocity({'opacity': 0}, {duration: 500, delay: delay, display: 'none', easing: [.24,.63,.5,.99]});\n        setTimeout(function() {\n          $(e).detach();\n        }, 600+delay);\n      });\n      var paramtype = 'category';\n      var price = null;\n      sortUrl(price, param, paramtype);\n\n    });\n  });\n\n  $(pBrand).each(function(i,e) {\n    var param = $(e).data('brand');\n\n    $(e).on('click', function() {\n      $(pages).each(function(i,e) {\n        var delay = 50 * i;\n        $(e).velocity({'opacity': 0}, {duration: 500, delay: delay, display: 'none', easing: [.24,.63,.5,.99]});\n        setTimeout(function() {\n          $(e).detach();\n        }, 600+delay);\n      });\n      var paramtype = 'brand';\n      var price = null;\n      sortUrl(price, param, paramtype);\n    });\n  });\n}\n\nfunction sortPriceController(initDirection) {\n  var direction = initDirection;\n\n  function setDirection(dir) {\n    direction = dir;\n  }\n\n  function getDirection() {\n    return direction;\n  }\n\n  var priceSorter = $('.menu-left').find('.sort-links > .price-sorter');\n\n  if ( !priceSorter ) {\n    return;\n  }\n\n  $(priceSorter).on('click', function() {\n    var currentDir = getDirection();\n\n    console.log(currentDir);\n\n    if ( currentDir === 'asc' ) {\n      setDirection('desc');\n      var price = 'price_asc';\n      sortUrl(price);\n\n    }\n\n    if ( currentDir === 'desc' ) {\n      setDirection('asc');\n      var price = 'price_desc';\n      sortUrl(price);\n    }\n  });\n}\n\nfunction scrollController() {\n  var pages = $('body').find('.page.products.hidden'),\n      content = $('body').find('.site-content'),\n      height = $(content).height(),\n      windowHeight = $(window).height();\n\n  if ( !pages ) {\n    return;\n  }\n\n  $(window).on('scroll', function() {\n    var scroll = $(document).scrollTop(),\n        height = $(content).height();\n\n    if ( scroll >= ((height - windowHeight) - 700) ) {\n      window.requestAnimationFrame(function() {\n        updateView();\n      });\n    }\n  });\n\n  function updateView() {\n    var trig = 0;\n    if (!pages[0] || trig > 0 ) {\n      return;\n    } else {\n      $(pages[0]).removeClass('hidden');\n      trig++;\n      setTimeout(function() {\n        scrollController();\n      }, 1000);\n    }\n  }\n}\n\nvar fpBackgroundController = function() {\n  var bgContainer = $('body').find('.bg-container'),\n      firstImg = $(bgContainer).find('img'),\n      index;\n\n  if ( !bgContainer ) {\n    return;\n  }\n\n  if ( firstImg && firstImg[0] ) {\n    if (firstImg[0].complete) {\n      imagesHandler();\n    } else {\n      firstImg.load(imagesHandler);\n    }\n  }\n\n  function imagesHandler() {\n    setIndex(1);\n    $(firstImg).velocity({\n      'opacity': 1\n    }, {duration: 500, delay: 0, display: 'block', easing: [.24,.63,.5,.99]});\n\n    for( var i = 2; i < 7; i++ ) {\n      var img = $('<img />').attr('src', site.theme_path + '/img/bg/bg' + i + '.png').attr('class', 'bg-' + i);\n      $(bgContainer).append(img);\n    }\n\n    setTimeout(controller, 8000);\n  }\n\n  function controller() {\n    var j = getIndex(),\n        k = j+1;\n\n    if ( k > 6 ) {\n      k = 1;\n    }\n\n    var curImg = $(bgContainer).find('img.bg-' + j),\n        newImg = $(bgContainer).find('img.bg-' + k);\n\n    window.requestAnimationFrame(animateIn(newImg));\n    window.requestAnimationFrame(animateOut(curImg));\n\n    setIndex(k);\n\n    setTimeout(controller, 4000);\n  }\n\n  function animateIn(image) {\n    $(image).velocity({\n      'opacity': 1\n    }, {duration: 1000, delay: 0, display: 'block', easing: [.24,.63,.5,.99]});\n  }\n\n  function animateOut(image) {\n    $(image).velocity({\n      'opacity': 0\n    }, {duration: 1000, delay: 0, display: 'block', easing: [.24,.63,.5,.99]});\n  }\n\n  function getIndex() {\n    n = index;\n    return n;\n  }\n\n  function setIndex(newIndex) {\n    index = newIndex;\n  }\n}\n\nvar fpVideoController = function() {\n  var vid = document.getElementById('frontpage-video');\n\n  if (!vid) {\n    return;\n  } else {\n    var spinner = $('body').find('.spinner'),\n        container = $('body').find('.front-video-container'),\n        vidElement = $(container).find('#frontpage-video'),\n        movingContent = $('body').find('.moving-content'),\n        width = $(window).width(),\n        vidHeight = ((width/100*80)/16)*9;\n\n    addEventListeners();\n  }\n\n  function addEventListeners() {\n    vid.addEventListener('canplaythrough', animShowVideo);\n    vid.addEventListener('ended', animOutVideo);\n  }\n\n  function animShowVideo() {\n    $(spinner).addClass('hidden');\n\n    $(container).velocity({\n      'height': vidHeight\n    }, {duration: 700, delay: 0, easing: [.24,.63,.5,.99]});\n\n    $(vidElement).velocity({\n      'opacity': 1\n    }, {duration: 700, delay: 0, display: 'block', easing: [.24,.63,.5,.99]});\n\n    $(movingContent).velocity({\n      'top': vidHeight + 30\n    }, {duration: 700, delay: 0, display: 'block', easing: [.24,.63,.5,.99]});\n\n    setTimeout(function() {\n      if ( vid.paused ) {\n        vid.play();\n      }\n    }, 700);\n  }\n\n  function animOutVideo() {\n    $(vidElement).velocity({\n      'opacity': 0\n    }, {duration: 300, delay: 0, display: 'block', easing: [.24,.63,.5,.99]});\n\n    $(container).velocity({\n      'height': 60\n    }, {duration: 1000, delay: 400, easing: [.24,.63,.5,.99]});\n\n    $(movingContent).velocity({\n      'top': 90\n    }, {duration: 1000, delay: 400, display: 'block', easing: [.24,.63,.5,.99]});\n\n    scrollTo(0);\n  }\n}\n\n\nvar scrollHeaderController = function() {\n  var linkHeader = $('body').find('.header-link-row'),\n      width = $(window).width(),\n      scroll;\n\n  $(window).on('scroll', modifyHeader);\n\n  function modifyHeader() {\n    scroll = $(window).scrollTop();\n\n    if ( scroll > 500 ) {\n      $(linkHeader).addClass('hidden');\n    }\n    if ( scroll < 500 ) {\n      $(linkHeader).removeClass('hidden');\n    }\n  }\n}\n\nfunction validateEmail(email) {\n  var regex = /^(([^<>()[\\]\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/i;\n  return regex.test(email);\n}\n\nfunction validateInput(input) {\n  var allowedChars = /^[\\u00C0-\\u1FFF\\u2C00-\\uD7FF\\w&.,\\- ]+$/;\n  return allowedChars.test(input);\n}\n\nfunction validateNumber(input) {\n  var isNumber = /^(?=.*[0-9])[+()0-9]+$/;\n  return isNumber.test(input);\n}\n\nvar reserveFormController = function() {\n  var form = $('body').find('form.reserve'),\n      emailInput = $(form).find('input[type=email]'),\n      nameInput = $(form).find('input[type=text].name'),\n      phoneInput = $(form).find('input[type=text].phone'),\n      submitBtn = $(form).find('.submit-btn > a');\n\n  function validateEmailOnBlur() {\n    $(emailInput).on('blur', function() {\n      var value = $(this).val();\n\n      if ( value.length === 0 ) {\n        if ( $(this).hasClass('error') ) {\n          $(this).removeClass('error');\n        }\n        return;\n      }\n\n      if ( value.length !== 0 ) {\n        var isEmail = validateEmail(value);\n\n        if( !isEmail && !$(this).hasClass('error') ) {\n          $(this).addClass('error');\n        }\n\n        if( isEmail && $(this).hasClass('error') ) {\n          $(this).removeClass('error');\n        }\n      }\n    });\n  }\n\n  function validateNameOnBlur() {\n    $(nameInput).on('blur', function() {\n      var value = $(this).val();\n\n      if ( value.length === 0 ) {\n        if ( $(this).hasClass('error') ) {\n          $(this).removeClass('error');\n        }\n        return;\n      }\n\n      if ( value.length !== 0 ) {\n        var isTrustedCharacters = validateInput(value);\n\n        if( !isTrustedCharacters && !$(this).hasClass('error') ) {\n          $(this).addClass('error');\n        }\n\n        if( isTrustedCharacters && $(this).hasClass('error') ) {\n          $(this).removeClass('error');\n        }\n      }\n    });\n  }\n\n  function validateNumberOnBlur() {\n    $(phoneInput).on('blur', function() {\n      var value = $(this).val();\n\n      if ( value.length === 0 ) {\n        if ( $(this).hasClass('error') ) {\n          $(this).removeClass('error');\n        }\n        return;\n      }\n\n      if ( value.length !== 0 ) {\n        var isNumber = validateNumber(value);\n\n        if ( !isNumber && !$(this).hasClass('error') ) {\n          $(this).addClass('error');\n        }\n\n        if ( isNumber && $(this).hasClass('error') ) {\n          $(this).removeClass('error');\n        }\n      }\n    });\n  }\n\n  function submitListener() {\n    $(submitBtn).on('click', function(event) {\n      event.preventDefault(),\n      inputs = $(form).find('input'),\n      validSuccess = $('body').find('.validation.success');\n      dataObject = {},\n      inputArray = [];\n\n      $(inputs).each(function(i, e) {\n        if ( $(e).hasClass('error') || $(e).val().length === 0 ) {\n          return;\n        } else {\n          var object = {\n            name: e.name,\n            value: $(e).val()\n          }\n          inputArray.push(object);\n        }\n      });\n\n      var data = packData();\n      sendForm(data);\n    });\n\n    function packData() {\n      dataObject.customer_html = '<h4>Navn:</h4><h2>' + inputArray[0].value + '</h2>';\n      dataObject.customer_html += '<h4>TLF:</h4><h2>' + inputArray[1].value + '</h2>';\n      dataObject.customer_html += '<h4>EMAIL:</h4><h2>' + inputArray[2].value + '</h2>';\n      dataObject.customer_email = inputArray[2].value;\n\n      return dataObject;\n    }\n\n    function sendForm(data) {\n      var customerData = JSON.stringify(data);\n\n        $.ajax({\n          url: site.ajax_url + '?action=reserve',\n          type: 'POST',\n          data: customerData,\n          success: function(response) {\n            var stripResponse = $.trim(response);\n            console.log(stripResponse);\n            if ( stripResponse === 'Success' ) {\n              animateSuccess();\n            }\n            if ( stripResponse === 'Error' ) {\n\n            }\n          },\n          error: function(response) {\n            console.log(response);\n          }\n        });\n    }\n\n    function animateSuccess() {\n      $(form).velocity({\n        'opacity': [0, 1]\n      }, {duration: 300, delay: 0, easing: [.24,.63,.5,.99], display: 'none'});\n\n      $(validSuccess).velocity({\n        'opacity': [1, 0]\n      }, {duration: 300, delay: 350, easing: [.24,.63,.5,.99], display: 'block'});\n\n      setTimeout(function() {\n        window.location.href = window.location.href;\n      }, 1000);\n    }\n  }\n\n  validateNumberOnBlur();\n  validateEmailOnBlur();\n  validateNameOnBlur();\n  submitListener();\n}\n\n\nfunction shopMsg(title, msg) {\n  var atcModal = $('body').find('.atc-modal');\n\n  if ( !msg ) {\n    var msg = '<span>- blev tilføjet til kurven.</span>';\n  } else {\n    var msg = msg;\n  }\n\n  var html = '<h3>' + title + '</h3>' + msg;\n\n  $(atcModal).append(html);\n\n  function animate() {\n    $(atcModal).velocity({\n      'opacity': [1, 0],\n      'top': [150, 300],\n      'z-index': [999999999998, 999999999998]\n    }, {duration: 400, delay: 0, easing: 'easeInOutSine'});\n\n    $(atcModal).velocity({\n      'opacity': [0, 1],\n      'top': [300, 150],\n      'z-index': [999999999998, 99999999998]\n    }, {duration: 400, delay: 1400, easing: 'easeInOutSine'});\n  }\n\n  setTimeout(function() {\n    animate();\n  }, 100);\n\n  setTimeout(function() {\n    $(atcModal).html('');\n    $(atcModal).css({\n      'z-index': -1000\n    });\n  }, 2500);\n}\n\n\nvar productTextController = function() {\n  var textIcon = $('body').find('.text-icon'),\n      productLeft = $('body').find('.product-left'),\n      productRight = $('body').find('.product-right');\n\n  $(textIcon).on('click', function() {\n    toggleClass();\n  });\n\n  function toggleClass() {\n    $(textIcon).toggleClass('off');\n    $(productLeft).toggleClass('off');\n    $(productRight).toggleClass('off');\n  }\n\n  setTimeout(toggleClass, 800);\n}\n\nvar singleProductHeightController = function() {\n  var mainImage = $('.main-image img'),\n      iFrame = $('body').find('iframe');\n\n  if ( mainImage && mainImage[0] ) {\n    if (mainImage[0].complete) {\n      handler();\n    } else {\n      mainImage.load(handler);\n    }\n  } else {\n    return;\n  }\n\n  function handler() {\n    var contentHeight = $('.product-content').height(),\n        imageHeight = $('.main-image img').height();\n\n    if ( contentHeight && imageHeight < contentHeight ) {\n      $('.main-image').css({\n        'height': contentHeight + 'px'\n      });\n    } else {\n      return;\n    }\n    setMenuHeight();\n  }\n}\n\nvar embedVidController = function() {\n  var vidFrame = $('body').find('.youtube-frame');\n\n  if ( vidFrame.length > 0 ) {\n    initVideo();\n  } else {\n    return;\n  }\n\n  function initVideo() {\n    var vidUrl = $(vidFrame).attr('data-href');\n        if ( vidUrl.indexOf('=') !== -1 ) {\n          var vidId = vidUrl.split('='),\n              id = vidId[1];\n        } else {\n          var vidId = vidUrl.split('/');\n          id = vidId[3];\n        }\n\n    var width = $(window).width(),\n        height = (((width/100)*90) / 16) * 9;\n\n    var constructedHtml = '<iframe width=\"' + width + '\" height=\"' + height + '\" src=\"https://www.youtube.com/embed/' + id + '?rel=0&amp;showinfo=0\" frameborder=\"0\" allowfullscreen></iframe>';\n\n    $(vidFrame).html(constructedHtml);\n  }\n};\n\n\nvar gridCartController = function() {\n  var addBtn = $('body').find('.add-button'),\n      cart = $('body').find('.cart-contents');\n\n  $(addBtn).each(function(i, e) {\n    var id = $(this).attr('data-href'),\n        prodTitle = $(this).attr('data-title');\n\n    $(this).on('click', function(event) {\n      console.log('clicked');\n      event.preventDefault();\n      var cartNumber = $('body').find('.cart-icon h5'),\n          cartInt = parseInt($('body').find('.cart-icon h5').text()),\n          url = site.ajax_url + '?action=sinus_add',\n          dataObject = {\n            'product_id': id\n          }\n\n      data = JSON.stringify(dataObject);\n\n      $.ajax({\n        url: url,\n        type: 'POST',\n        data: data,\n        dataType: 'html',\n        success: function(response) {\n          var updatedNum = cartInt + 1;\n          cartNumber.html(updatedNum);\n          $(cart).html(response);\n          shopMsg(prodTitle);\n\n          setTimeout(function() {\n            window.location.href = window.location.href;\n          }, 1000);\n        },\n        error: function(response) {\n          console.log('error -', response);\n        }\n      });\n    });\n  });\n};\n\nvar removeFromCartController = function() {\n    var cart = $('body').find('.cart-contents'),\n        remBtn = $(cart).find('.remove-icon');\n\n  $(remBtn).each(function(i, e) {\n    var id = $(this).attr('data-id'),\n        qtyElem = $(this).siblings('.elem-qty-total'),\n        qty = parseInt($(qtyElem).attr('data-qty'));\n\n\n    $(this).on('click', function() {\n      console.log(qty, id);\n      var cartNumber = $('body').find('.cart-icon h5'),\n          cartInt = parseInt($('body').find('.cart-icon h5').text()),\n          url = site.ajax_url + '?action=sinus_remove',\n          dataObject = {\n            'product_id': id,\n            'quantity': qty\n          }\n\n      data = JSON.stringify(dataObject);\n\n      $.ajax({\n        url: url,\n        type: 'POST',\n        data: data,\n        dataType: 'html',\n        success: function(response) {\n          var updatedNum = cartInt - qty;\n          cartNumber.html(updatedNum);\n          $(cart).html(response);\n          window.location.href = window.location.href;\n        },\n        error: function(response) {\n          console.log('error -', response);\n        }\n      });\n    });\n  });\n};\n\nfunction setMenuHeight() {\n  setTimeout(function() {\n    var mainMenu = $('body').find('.main-menu'),\n        siteContent = $('body').find('.site-content'),\n        documentHeight = $('.site-content').height();\n\n     // set menu height, relative to content height (minus footer)\n    $(mainMenu).css({\n      'height': documentHeight - 325 + 'px'\n    });\n  }, 1000);\n}\n\nvar MenuController = function() {\n  var menuBtn = $('body').find('.menu-icon'),\n      mainMenu = $('body').find('.main-menu'),\n      menuLinks = $(mainMenu).find('li'),\n      menuHeaders = $(mainMenu).find('h3'),\n      searchForm = $('body').find('.search-form'),\n      cartIcon = $('body').find('.cart-icon'),\n      cartContents = $('body').find('.cart-modal.cart-contents'),\n      width = $(window).width();\n      setMenuHeight();\n\n      $(menuBtn).on('click', animateMenu);\n\n      function animateMenu() {\n        if ( $(mainMenu).hasClass('hidden') ) {\n          $(mainMenu).removeClass('hidden');\n          $(this).addClass('open');\n          scrollTo('0px');\n          updateHeaderOpen();\n          addEventListener();\n        } else {\n          $(mainMenu).addClass('hidden');\n          $(this).removeClass('open');\n          updateHeaderClose();\n        }\n      }\n\n\n      function updateHeaderOpen() {\n        var rawIconCss = $(cartIcon).css('right'),\n            rawSearchCss = $(searchForm).css('right'),\n            rawCartContCss = $(cartContents).css('right'),\n            iconRight = parseInt(rawIconCss.replace('px', '')),\n            searchRight = parseInt(rawSearchCss.replace('px', '')),\n            cartContRight = parseInt(rawCartContCss.replace('px', ''));\n\n\n            $(cartIcon).velocity({\n              'right': iconRight + 230 + 'px'\n            }, {duration: 400, delay: 100, easing: [.24,.63,.5,.99]});\n\n            $(searchForm).velocity({\n              'right': searchRight + 230 + 'px'\n            }, {duration: 400, delay: 0, easing: [.24,.63,.5,.99]});\n\n            $(cartContents).velocity({\n              'right': cartContRight + 230 + 'px'\n            }, {duration: 400, delay: 150, easing: [.24,.63,.5,.99]});\n      }\n\n      function updateHeaderClose() {\n            $(cartIcon).velocity({\n              'right': 90\n            }, {duration: 300, delay: 200, easing: [.24,.63,.5,.99]});\n\n            $(searchForm).velocity({\n              'right': 165\n            }, {duration: 300, delay: 300, easing: [.24,.63,.5,.99]});\n\n            $(cartContents).velocity({\n              'right': 80\n            }, {duration: 300, delay: 250, easing: [.24,.63,.5,.99]});\n      }\n\n      function addEventListener() {\n        $(menuLinks).on('click', function(e) {\n          e.preventDefault();\n          var aHref =  $(this).find('a');\n          var href = $(aHref).attr('href');\n\n          $(menuLinks).each(function(i, elem) {\n            var delay = i * 20;\n\n            $(elem).velocity({\n              'opacity': [0, 1]\n            }, {duration: 100, delay: delay, easing: 'easeInOutSine'});\n\n          });\n\n          $(menuHeaders).each(function(i, elem) {\n            var delay = i * 30;\n\n            $(elem).velocity({\n              'opacity': [0, 1]\n            }, {duration: 100, delay: delay, easing: 'easeInOutSine'});\n          });\n\n          setTimeout(navigate(href), 1200);\n        });\n      }\n\n      function navigate(href) {\n        setTimeout(function() {\n          $(menuBtn).removeClass('open');\n          $(mainMenu).addClass('hidden');\n          updateHeaderClose();\n        }, 1000);\n\n        setTimeout(function() {\n          window.location.href = href;\n        }, 1300);\n      }\n};\n\nvar CartController = function() {\n  var cartIcon = $('body').find('.cart-icon'),\n      headerLinkRow = $('body').find('.header-link-row'),\n      cartContents = $('body').find('.cart-modal.cart-contents.hidden');\n\n  $(cartIcon).on('click', function(e) {\n    if ( headerLinkRow.hasClass('hidden') ) {\n      $(cartContents).css({\n        'top': 65 + 'px'\n      });\n    } else {\n      $(cartContents).css({\n        'top': 95 + 'px'\n      });\n    }\n    $(cartContents).toggleClass('hidden');\n  });\n}\n\n\n// http://sin.us/wp-json/posts?type=product&filter[product_cat]=hifi&filter[orderby]=price&filter[order]=asc\n\n"],"sourceRoot":"/source/"}